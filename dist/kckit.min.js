"use strict";function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e,t,a){"function"==typeof define&&define.amd?define(a):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=a():e[t]=a()}(window,"KC",function(){var e={lang:"zh_cn",joint:"・",db:{},path:{db:"/kcdb/",pics:{ships:"/kcpic/ships/"}},statSpeed:{5:"低速",10:"高速"},getStatSpeed:function(e){return this.statSpeed[parseInt(e)]},statRange:{1:"短",2:"中",3:"长",4:"超长"},getStatRange:function(e){return this.statRange[parseInt(e)]},textRank:{1:"|",2:"||",3:"|||",4:"\\",5:"\\\\",6:"\\\\\\",7:"》"}},t=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"getName",value:function(t){return t=t||e.lang,this.name?this.name[t]||this.name:null}},{key:"_name",get:function(){return this.getName()}}]),t}(),a=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return $.extend(!0,a,e),a}return _inherits(t,e),t}(t);e.Entity=a;var r=function(a){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,Object.getPrototypeOf(r).call(this));return $.extend(!0,t,e),t}return _inherits(r,a),_createClass(r,[{key:"getName",value:function(a,r){r=r||e.lang;var n=t.prototype.getName.call(this,r),i=a&&!a==!0?a:"small";return a?n.replace(/（([^（^）]+)）/g,"<"+i+">($1)</"+i+">"):n}},{key:"getType",value:function(t){return t=t||e.lang,this.type?_g.data.item_types[this.type].name[t]:null}},{key:"getIconId",value:function(){return e.db.item_types[this.type].icon}},{key:"getCaliber",value:function(){var e=this.getName(!1,"ja_jp"),t=parseFloat(e);return t}},{key:"getPower",value:function(){return this.stat[e.db.item_types[this.type].main_attribute||"fire"]}},{key:"_icon",get:function(){return"assets/images/itemicon/"+this.getIconId()+".png"}}]),r}(t);e.Equipment=r;var n=function(t){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,Object.getPrototypeOf(a).call(this));return $.extend(!0,t,e),t}return _inherits(a,t),_createClass(a,[{key:"getName",value:function(t,a){t=t||"",a=a||e.lang;var r=this.getSuffix(a);return(this.name[a]||this.name.ja_jp)+(r?(t===!0?e.joint:t)+r:"")}},{key:"getNameNoSuffix",value:function(t){return t=t||e.lang,this.name[t]||this.name.ja_jp}},{key:"getSuffix",value:function(t){return t=t||e.lang,this.name.suffix?e.db.ship_namesuffix[this.name.suffix][t]||e.db.ship_namesuffix[this.name.suffix].ja_jp||"":""}},{key:"getType",value:function(t){return t=t||e.lang,this.type?_g.data.ship_types[this.type].full_zh:null}},{key:"getSeriesData",value:function(){return this.series?_g.data.ship_series[this.series].ships:[{id:this.id}]}},{key:"getPic",value:function(t){var a=this.getSeriesData();t=parseInt(t||0);for(var r=function(t,a){return"undefined"!=typeof node&&node&&node.path&&e.path.pics.ships?node.path.join(e.path.pics.ships,t+"/"+a+".webp"):e.path.pics.ships?e.path.pics.ships+t+"/"+a+".png":"/"+t+"/"+a+".png"},n=0;n<a.length;n++)if(a[n].id==this.id){switch(t){case 0:case 1:case 2:case 3:case 12:case 13:case 14:return r(this.id,t);default:return a[n].illust_delete?r(a[n-1].id,t):r(this.id,t)}break}}},{key:"getSpeed",value:function(t){return t=t||e.lang,e.statSpeed[parseInt(this.stat.speed)]}},{key:"getRange",value:function(t){return t=t||e.lang,e.statRange[parseInt(this.stat.range)]}},{key:"getEquipmentTypes",value:function(){return e.db.ship_types[this.type].equipable.concat(this.additional_item_types||[]).sort(function(e,t){return e-t})}},{key:"getAttribute",value:function(t,r){r=r||1,r>a.lvlMax&&(r=a.lvlMax);var n=function(e,t,a){return e=e||1,t=parseFloat(t),a=parseFloat(a)||t,t<0||a<0?-1:t==a?a:Math.floor(t+(a-t)*e/99)},i=void 0;switch(t){case"hp":return i=this.stat.hp,r>99&&(i=this.stat.hp>=90?this.stat.hp+9:this.stat.hp>=70?this.stat.hp+8:this.stat.hp>=50?this.stat.hp+7:this.stat.hp>=40?this.stat.hp+6:this.stat.hp>=30?this.stat.hp+5:this.stat.hp+4,i>this.stat.hp_max&&(i=this.stat.hp_max)),i;case"speed":return e.getStatSpeed(this.stat.speed);case"range":return e.getStatRange(this.stat.range);case"luck":return r>99?this.stat.luck+3:this.stat.luck;case"fuel":case"ammo":return r>99?Math.floor(.85*this.consum[t]):this.consum[t];case"aa":case"armor":case"fire":case"torpedo":return this.stat[t+"_max"]||this.stat[t];default:return n(r,this.stat[t],this.stat[t+"_max"])}}},{key:"getRel",value:function(t){if(t){if(!this.rels[t]&&this.remodel&&this.remodel.prev)for(var a=e.db.ships[this.remodel.prev];a;){if(a.rels&&a.rels[t])return a.rels[t];a=a.remodel&&a.remodel.prev?e.db.ships[a.remodel.prev]:null}return this.rels[t]}return this.rels}},{key:"getCV",value:function(t){var a=this.getRel("cv");if(a)return e.db.entities[a].getName(t||e.lang)}},{key:"getIllustrator",value:function(t){var a=this.getRel("illustrator");if(a)return e.db.entities[a].getName(t||e.lang)}},{key:"_type",get:function(){return this.getType()}},{key:"_pics",get:function(){for(var e=[],t=0;t<15;t++)e.push(this.getPic(t));return e}},{key:"_speed",get:function(){return this.getSpeed()}},{key:"_range",get:function(){return this.getRange()}},{key:"_cv",get:function(){return this.getCV()}},{key:"_illustrator",get:function(){return this.getIllustrator()}}]),a}(t);n.lvlMax=155,e.Ship=n,e.dbLoad=function(t,i,s,p){return $.ajax({url:e.path.db+"/"+t+".json",dataType:"text",success:function(p){var o=[];i&&(o=i(p)),"undefined"==typeof e.db[t]&&(e.db[t]={}),o.forEach(function(i){if(i){var s=JSON.parse(i);switch(t){case"ships":e.db[t][s.id]=new n(s);break;case"items":e.db[t][s.id]=new r(s);break;case"entities":e.db[t][s.id]=new a(s);break;default:e.db[t][s.id]=s}}}),s&&s(p)},complete:function(e,t){p&&p(e,t)}})};var i={equipmentType:{SmallCaliber:1,SmallCaliberHigh:2,SmallCaliberAA:3,MediumCaliber:4,LargeCaliber:5,SuperCaliber:6,SecondaryGun:7,SecondaryGunHigh:8,SecondaryGunAA:9,APShell:11,Torpedo:12,SubmarineTorpedo:13,MidgetSubmarine:14,ReconSeaplane:15,ReconSeaplaneNight:16,SeaplaneBomber:17,CarrierFighter:18,TorpedoBomber:19,DiveBomber:20,CarrierRecon:21,Autogyro:22,AntiSubPatrol:23,SmallRadar:24,LargeRadar:25,DepthCharge:26,Sonar:27,LargeSonar:28,AAGun:29,AAGunConcentrated:30,AAFireDirector:31,LandingCraft:38,Searchlight:39,LargeFlyingBoat:45,SearchlightLarge:46,SuparRadar:47,CarrierRecon2:50,SeaplaneFighter:51,AmphibiousCraft:52,LandBasedAttacker:53,Interceptor:54},shipType:{Carriers:[9,10,11],LightCruisers:[2,3,21,28],Submarines:[13,14]},calcByShip:{},calc:{}};return i.calculate=function(t,a,s,p,o,u){if(!t||!a)return 0;_instanceof(a,n)||(a=e.db.ships[a]);var l=0,c={main:0,secondary:0,torpedo:0,seaplane:0,apshell:0,radar:0},h=function(e){e=e||{};var t=0;return $.inArray(a.type,i.shipType.Carriers)>-1&&!e.isNight?e.returnZero?0:-1:(t=a.stat.torpedo_max||0,a.slot.map(function(a,r){s[r]&&(t+=s[r].type!=i.equipmentType.TorpedoBomber||e.isNight?s[r].stat.torpedo||0:0,p[r]&&!e.isNight&&(t+=Math.sqrt(p[r])*i.getStarMultiper(s[r].type,"torpedo")))}),t)},m=0;switch(s=s.map(function(t){return t?_instanceof(t,r)?t:e.db.equipments?e.db.equipments[t]:e.db.items[t]:null})||[],p=p||[],o=o||[],u=u||{},s.forEach(function(e){e&&($.inArray(e.type,i.equipmentType.MainGuns)>-1?c.main+=1:$.inArray(e.type,i.equipmentType.SecondaryGuns)>-1?c.secondary+=1:$.inArray(e.type,i.equipmentType.Torpedos)>-1?c.torpedo+=1:$.inArray(e.type,i.equipmentType.Seaplanes)>-1?c.seaplane+=1:e.type==i.equipmentType.APShell?c.apshell+=1:$.inArray(e.type,i.equipmentType.Radars)>-1&&(c.radar+=1))}),t){case"fighterPower":return m=0,a.slot.map(function(e,t){if(s[t]&&$.inArray(s[t].type,i.equipmentType.Fighters)>-1&&e){if(m=Math.sqrt(e)*(s[t].stat.aa||0),s[t].type==i.equipmentType.CarrierFighter)switch(o[t]){case 1:case"1":m+=1;break;case 2:case"2":m+=4;break;case 3:case"3":m+=6;break;case 4:case"4":m+=11;break;case 5:case"5":m+=16;break;case 6:case"6":m+=17;break;case 7:case"7":m+=25}else if($.inArray(s[t].type,i.equipmentType.Recons)==-1){var a=s[t].type==i.equipmentType.SeaplaneBomber?9:3;m+=1==o[t]?1:a/6*(o[t]-1)}l+=Math.floor(m)}}),l;case"fighterPower_v2":return i.calcByShip.fighterPower_v2(a,s,p,o);case"shelling":case"shellingDamage":return $.inArray(a.type,i.shipType.Submarines)>-1?"-":(l=i.calcByShip.shellingPower(a,s,p,o),l&&l>-1?Math.floor(l):"-");case"torpedo":case"torpedoDamage":return l=h(),l&&l>-1?Math.floor(l):"-";case"nightBattle":return!a.additional_night_shelling&&$.inArray(a.type,i.shipType.Carriers)>-1?"-":(l=i.calcByShip.shellingPower(a,s,p,o,{isNight:!0})+h({isNight:!0,returnZero:!0}),a.slot.map(function(e,t){s[t]&&p[t]&&(l+=Math.sqrt(p[t])*i.getStarMultiper(s[t].type,"night"))}),c.torpedo>=2?"雷击CI "+Math.floor(1.5*l)+" x 2":c.main>=3?"炮击CI "+Math.floor(2*l):2==c.main&&c.secondary>=1?"炮击CI "+Math.floor(1.75*l):c.main>=1&&1==c.torpedo?"炮雷CI "+Math.floor(1.3*l)+" x 2":2==c.main&&c.secondary<=0&&c.torpedo<=0||1==c.main&&c.secondary>=1&&c.torpedo<=0||0==c.main&&c.secondary>=2&&c.torpedo>=0?"连击 "+Math.floor(1.2*l)+" x 2":"通常 "+Math.floor(l));case"addHit":return a.slot.map(function(e,t){s[t]&&(l+=s[t].stat.hit||0)}),l>=0?"+"+l:l;case"addArmor":return a.slot.map(function(e,t){s[t]&&(l+=s[t].stat.armor||0)}),l;case"addEvasion":return a.slot.map(function(e,t){s[t]&&(l+=s[t].stat.evasion||0)}),l;case"losPower":return i.calcByShip.losPower(a,s,p,o,u);default:return i.calcByShip[t](a,s,p,o,u)}return"-"},i.equipmentType.MainGuns=[i.equipmentType.SmallCaliber,i.equipmentType.SmallCaliberHigh,i.equipmentType.SmallCaliberAA,i.equipmentType.MediumCaliber,i.equipmentType.LargeCaliber,i.equipmentType.SuperCaliber],i.equipmentType.SmallCalibers=[i.equipmentType.SmallCaliber,i.equipmentType.SmallCaliberHigh,i.equipmentType.SmallCaliberAA],i.equipmentType.MediumCalibers=[i.equipmentType.MediumCaliber],i.equipmentType.LargeCalibers=[i.equipmentType.LargeCaliber,i.equipmentType.SuperCaliber],i.equipmentType.SecondaryGuns=[i.equipmentType.SecondaryGun,i.equipmentType.SecondaryGunHigh,i.equipmentType.SecondaryGunAA],i.equipmentType.APShells=[i.equipmentType.APShell],i.equipmentType.Torpedos=[i.equipmentType.Torpedo,i.equipmentType.SubmarineTorpedo],i.equipmentType.Seaplanes=[i.equipmentType.ReconSeaplane,i.equipmentType.ReconSeaplaneNight,i.equipmentType.SeaplaneBomber,i.equipmentType.SeaplaneFighter],i.equipmentType.Fighters=[i.equipmentType.SeaplaneBomber,i.equipmentType.CarrierFighter,i.equipmentType.TorpedoBomber,i.equipmentType.DiveBomber,i.equipmentType.SeaplaneFighter,i.equipmentType.LandBasedAttacker,i.equipmentType.Interceptor],i.equipmentType.Recons=[i.equipmentType.ReconSeaplane,i.equipmentType.ReconSeaplaneNight,i.equipmentType.CarrierRecon,i.equipmentType.CarrierRecon2,i.equipmentType.LargeFlyingBoat],i.equipmentType.SeaplaneRecons=[i.equipmentType.ReconSeaplane,i.equipmentType.ReconSeaplaneNight,i.equipmentType.LargeFlyingBoat],i.equipmentType.SeaplaneBombers=[i.equipmentType.SeaplaneBomber,i.equipmentType.SeaplaneFighter],i.equipmentType.CarrierFighters=[i.equipmentType.CarrierFighter],i.equipmentType.CarrierRecons=[i.equipmentType.CarrierRecon,i.equipmentType.CarrierRecon2],i.equipmentType.CarrierBased=[i.equipmentType.CarrierFighter,i.equipmentType.TorpedoBomber,i.equipmentType.DiveBomber,i.equipmentType.CarrierRecon,i.equipmentType.CarrierRecon2],i.equipmentType.LandBased=[i.equipmentType.LandBasedAttacker,i.equipmentType.Interceptor],i.equipmentType.TorpedoBombers=[i.equipmentType.TorpedoBomber],i.equipmentType.DiveBombers=[i.equipmentType.DiveBomber],i.equipmentType.Autogyros=[i.equipmentType.Autogyro],i.equipmentType.AntiSubPatrols=[i.equipmentType.AntiSubPatrol],i.equipmentType.Aircrafts=[],[].concat(i.equipmentType.Seaplanes).concat(i.equipmentType.Recons).concat(i.equipmentType.CarrierBased).concat(i.equipmentType.Autogyros).concat(i.equipmentType.AntiSubPatrols).concat(i.equipmentType.LandBased).forEach(function(e){i.equipmentType.Aircrafts.indexOf(e)<0&&i.equipmentType.Aircrafts.push(e)}),i.equipmentType.Radars=[i.equipmentType.SmallRadar,i.equipmentType.LargeRadar,i.equipmentType.SuparRadar],i.equipmentType.SmallRadars=[i.equipmentType.SmallRadar],i.equipmentType.LargeRadars=[i.equipmentType.LargeRadar,i.equipmentType.SuparRadar],i.equipmentType.AntiSubmarines=[i.equipmentType.DepthCharge,i.equipmentType.Sonar,i.equipmentType.LargeSonar],i.equipmentType.DepthCharges=[i.equipmentType.DepthCharge],i.equipmentType.Sonars=[i.equipmentType.Sonar,i.equipmentType.LargeSonar],i.equipmentType.AAGuns=[i.equipmentType.AAGun,i.equipmentType.AAGunConcentrated],i.equipmentType.AAFireDirectors=[i.equipmentType.AAFireDirector],i.equipmentType.Searchlights=[i.equipmentType.Searchlight,i.equipmentType.SearchlightLarge],i.equipmentType.LandingCrafts=[i.equipmentType.LandingCraft,i.equipmentType.AmphibiousCraft],i.equipmentType.AmphibiousCrafts=[i.equipmentType.AmphibiousCraft],i.starMultiper={SmallCalibers:{shelling:1,night:1},MediumCalibers:{shelling:1,night:1},LargeCalibers:{shelling:1.5,night:1},SecondaryGuns:{shelling:1,night:1},APShells:{shelling:1,night:1},AAFireDirectors:{shelling:1,night:1},Searchlights:{shelling:1,night:1},AAGuns:{shelling:1,torpedo:1.2},Torpedos:{torpedo:1.2,night:1},DepthCharges:{shelling:.75,antisub:1},Sonars:{shelling:.75,antisub:1},Radars:{},Seaplanes:{},CarrierFighters:{fighter:.2},LandingCrafts:{shelling:1,night:1}},i.getStarMultiper=function(e,t){if(!i.starMultiper._init){var a=function(e){i.equipmentType[e]&&i.equipmentType[e].forEach&&i.equipmentType[e].forEach(function(t){i.starMultiper[t]=i.starMultiper[e]})};for(var r in i.starMultiper)a(r);i.starMultiper._init=!0}return i.starMultiper[e]?i.starMultiper[e][t]||0:0},i.shellingDamage=function(e,t,a,r){return this.calculate("shellingDamage",e,t,a,r)},i.torpedoDamage=function(e,t,a,r){return this.calculate("torpedoDamage",e,t,a,r)},i.fighterPower=function(e,t,a,r){return this.calculate("fighterPower",e,t,a,r)},i.fighterPower_v2=function(e,t,a,r){return this.calculate("fighterPower_v2",e,t,a,r)},i.nightBattle=function(e,t,a,r){return this.calculate("nightBattle",e,t,a,r)},i.addHit=function(e,t,a,r){return this.calculate("addHit",e,t,a,r)},i.addArmor=function(e,t,a,r){return this.calculate("addArmor",e,t,a,r)},i.addEvasion=function(e,t,a,r){return this.calculate("addEvasion",e,t,a,r)},i.losPower=function(e,t,a,r,n){return this.calculate("losPower",e,t,a,r,n)},i.calc.losPower=function(e){var t=function(e){e=$.extend({"(Intercept)":1},e),e.hqLv=5*Math.ceil(e.hqLv/5);var t={},s=0;$.each(a,function(){var a=e[this]*r[this];t[this]=a,s+=a});var p={};$.each(a,function(){p[this]=e[this]*n[this]});var o=0;return $.each(a,function(){var e=this;$.each(a,function(){var t=this;o+=p[e]*p[t]*i[e][t]})}),{x_estimate:t,y_estimate:s,x_std_error:p,y_std_error:o}},a=["(Intercept)","DiveBombers","TorpedoBombers","CarrierRecons","SeaplaneRecons","SeaplaneBombers","SmallRadars","LargeRadars","Searchlights","statLos","hqLv"],r={"(Intercept)":0,DiveBombers:1.03745043134563,TorpedoBombers:1.3679056374142,CarrierRecons:1.65940512636315,SeaplaneRecons:2,SeaplaneBombers:1.77886368594467,SmallRadars:1.0045778494921,LargeRadars:.990738063979571,Searchlights:.906965144360512,statLos:1.6841895400986,hqLv:-.614246711531445},n={"(Intercept)":4.66445565766347,DiveBombers:.0965028505325845,TorpedoBombers:.108636184978525,CarrierRecons:.0976055279516298,SeaplaneRecons:.0866229392463539,SeaplaneBombers:.0917722496848294,SmallRadars:.0492773648320346,LargeRadars:.0491221486053861,Searchlights:.0658283797225724,statLos:.0781594211213618,hqLv:.0369222352426548},i={"(Intercept)":{"(Intercept)":1,DiveBombers:-.147020064768061,TorpedoBombers:-.379236131621529,CarrierRecons:-.572858669501918,SeaplaneRecons:-.733913857017495,SeaplaneBombers:-.642621825152428,SmallRadars:-.674829588068364,LargeRadars:-.707418111752863,Searchlights:-.502304601556193,statLos:-.737374218573832,hqLv:-.05071933950163},DiveBombers:{"(Intercept)":-.147020064768061,DiveBombers:1,TorpedoBombers:.288506347076736,CarrierRecons:.365820372770994,SeaplaneRecons:.425744409856409,SeaplaneBombers:.417783698791503,SmallRadars:.409046013184429,LargeRadars:.413855653833994,Searchlights:.308730607324667,statLos:.317984916914851,hqLv:-.386740224500626},TorpedoBombers:{"(Intercept)":-.379236131621529,DiveBombers:.288506347076736,TorpedoBombers:1,CarrierRecons:.482215071254241,SeaplaneRecons:.584455876852325,SeaplaneBombers:.558515133495825,SmallRadars:.547260012897553,LargeRadars:.560437619378443,Searchlights:.437934879351188,statLos:.533934507932748,hqLv:-.405349979885748},CarrierRecons:{"(Intercept)":-.572858669501918,DiveBombers:.365820372770994,TorpedoBombers:.482215071254241,CarrierRecons:1,SeaplaneRecons:.804494553748065,SeaplaneBombers:.75671307047535,SmallRadars:.748420581669228,LargeRadars:.767980338133817,Searchlights:.589651513349878,statLos:.743851348255527,hqLv:-.503544281376776},SeaplaneRecons:{"(Intercept)":-.733913857017495,DiveBombers:.425744409856409,TorpedoBombers:.584455876852325,CarrierRecons:.804494553748065,SeaplaneRecons:1,SeaplaneBombers:.932444440578382,SmallRadars:.923988080549326,LargeRadars:.94904944359066,Searchlights:.727912987329348,statLos:.944434077970518,hqLv:-.614921413821462},SeaplaneBombers:{"(Intercept)":-.642621825152428,DiveBombers:.417783698791503,TorpedoBombers:.558515133495825,CarrierRecons:.75671307047535,SeaplaneRecons:.932444440578382,SeaplaneBombers:1,SmallRadars:.864289865445084,LargeRadars:.886872388674911,Searchlights:.68310647756898,statLos:.88122333327317,hqLv:-.624797255805045},SmallRadars:{"(Intercept)":-.674829588068364,DiveBombers:.409046013184429,TorpedoBombers:.547260012897553,CarrierRecons:.748420581669228,SeaplaneRecons:.923988080549326,SeaplaneBombers:.864289865445084,SmallRadars:1,LargeRadars:.872011318623459,Searchlights:.671926570242336,statLos:.857213501657084,hqLv:-.560018086758868},LargeRadars:{"(Intercept)":-.707418111752863,DiveBombers:.413855653833994,TorpedoBombers:.560437619378443,CarrierRecons:.767980338133817,SeaplaneRecons:.94904944359066,SeaplaneBombers:.886872388674911,SmallRadars:.872011318623459,LargeRadars:1,Searchlights:.690102027588321,statLos:.883771367337743,hqLv:-.561336967269448},Searchlights:{"(Intercept)":-.502304601556193,DiveBombers:.308730607324667,TorpedoBombers:.437934879351188,CarrierRecons:.589651513349878,SeaplaneRecons:.727912987329348,SeaplaneBombers:.68310647756898,SmallRadars:.671926570242336,LargeRadars:.690102027588321,Searchlights:1,statLos:.723228553177704,hqLv:-.518427865593732},statLos:{"(Intercept)":-.737374218573832,DiveBombers:.317984916914851,TorpedoBombers:.533934507932748,CarrierRecons:.743851348255527,SeaplaneRecons:.944434077970518,SeaplaneBombers:.88122333327317,SmallRadars:.857213501657084,LargeRadars:.883771367337743,Searchlights:.723228553177704,statLos:1,hqLv:-.620804120587684},hqLv:{"(Intercept)":-.05071933950163,DiveBombers:-.386740224500626,TorpedoBombers:-.405349979885748,CarrierRecons:-.503544281376776,SeaplaneRecons:-.614921413821462,SeaplaneBombers:-.624797255805045,SmallRadars:-.560018086758868,LargeRadars:-.561336967269448,Searchlights:-.518427865593732,statLos:-.620804120587684,hqLv:1}},s={DiveBombers:0,TorpedoBombers:0,CarrierRecons:0,SeaplaneRecons:0,SeaplaneBombers:0,SmallRadars:0,LargeRadars:0,Searchlights:0,statLos:1,hqLv:1};for(var p in e)s[p]=e[p];return t(s)},i.calc.TP=function(e){e=e||{};var t=0,a=e.ship||{},r=e.equipment||{};for(var n in a){var i=parseInt(a[n])||0,s=0;switch(n){case 1:case"1":case 19:case"19":case"dd":s=5;break;case 2:case"2":case"cl":s=2;break;case 5:case"5":case"cav":s=4;break;case 12:case"12":case 24:case"24":case"av":s=9.5;break;case 15:case"15":case"lha":s=12.25;break;case 29:case"29":case"ao":s=14.75;break;case 8:case"8":case"bbv":case 14:case"14":case"ssv":s=7;break;case 21:case"21":case"ct":s=6}t+=s*i}for(var n in r){var i=parseInt(r[n])||0,s=0;switch(n){case 68:case"68":s=8;break;case 75:case"75":s=5}t+=s*i}return t},i.calc.fighterPower=function(t,a,n,s){if(!t)return[0,0];t=_instanceof(t,r)?t:e.db.equipments?e.db.equipments[t]:e.db.items[t],a=a||0,n=n||0;var p=[],o={},u=[0,0];if(p[0]=[0,9],p[1]=[10,24],p[2]=[25,39],p[3]=[40,54],p[4]=[55,69],p[5]=[70,84],p[6]=[85,99],p[7]=[100,120],o.CarrierFighter=[0,0,2,5,9,14,14,22],o.SeaplaneBomber=[0,0,1,1,1,3,3,6],$.inArray(t.type,i.equipmentType.Fighters)>-1&&a){var l=(t.stat.aa||0)+(t.type==i.equipmentType.Interceptor?1.5*t.stat.evasion:0)+s*i.getStarMultiper(t.type,"fighter"),c=Math.sqrt(a)*l,h=p[n],m=0;t.type==i.equipmentType.CarrierFighter?m=o.CarrierFighter[n]:t.type==i.equipmentType.Interceptor?m=o.CarrierFighter[n]:t.type==i.equipmentType.SeaplaneFighter?m=o.CarrierFighter[n]:t.type==i.equipmentType.SeaplaneBomber&&(m=o.SeaplaneBomber[n]),u[0]+=Math.floor(c+Math.sqrt(h[0]/10)+m),u[1]+=Math.floor(c+Math.sqrt(h[1]/10)+m)}return u},i.calcByShip.shellingPower=function(e,t,a,r,n){n=n||{};var s=0,p=!1;if($.inArray(e.type,i.shipType.Carriers)>-1?p=!0:t.some(function(e){if(e&&!p&&$.inArray(e.type,i.equipmentType.CarrierBased)>-1)return p=!0,!0}),p&&!n.isNight){var o=0,u=0;return e.slot.map(function(e,r){t[r]&&(s+=1.5*t[r].stat.fire||0,t[r].type==i.equipmentType.TorpedoBomber&&(o+=t[r].stat.torpedo||0),u+=t[r].stat.bomb||0,$.inArray(t[r].type,i.equipmentType.SecondaryGuns)>-1&&(s+=Math.sqrt(1.5*(a[r]||0))))}),o||u?s+=Math.floor(1.5*(Math.floor(1.3*u)+o+e.stat.fire_max))+50:-1}s=e.stat.fire_max||0;var l=0,c=0;return e.slot.map(function(r,p){t[p]&&(s+=t[p].stat.fire||0,$.inArray(e.type,i.shipType.LightCruisers)>-1&&(4==t[p].id&&(l+=1),119!=t[p].id&&65!=t[p].id&&139!=t[p].id||(c+=1)),a[p]&&!n.isNight&&(s+=Math.sqrt(a[p])*i.getStarMultiper(t[p].type,"shelling")))}),s+2*Math.sqrt(c)+Math.sqrt(l)},i.calcByShip.fighterPower_v2=function(e,t,a,r){var n=[0,0];return e.slot.map(function(e,s){var p=i.calc.fighterPower(t[s],e,r[s]||0,a[s]||0);n[0]+=p[0],n[1]+=p[1]}),n},i.calcByShip.losPower=function(e,t,a,r,n){n=n||{},n.shipLv=n.shipLv||1,n.hqLv=n.hqLv||1,n.shipLv<0&&(n.shipLv=1),n.hqLv<0&&(n.hqLv=1);var s={DiveBombers:0,TorpedoBombers:0,CarrierRecons:0,SeaplaneRecons:0,SeaplaneBombers:0,SmallRadars:0,LargeRadars:0,Searchlights:0,statLos:Math.sqrt(e.getAttribute("los",n.shipLv)),hqLv:n.hqLv};return t.forEach(function(e){if(e)for(var t in s)i.equipmentType[t]&&i.equipmentType[t].push&&i.equipmentType[t].indexOf(e.type)>-1&&(s[t]+=e.stat.los)}),i.calc.losPower(s)},i.calcByShip.TP=function(e,t,a,r,n){var s={ship:{},equipment:{}};return s.ship[e.type]=1,t.forEach(function(e){e&&(s.equipment[e.id]||(s.equipment[e.id]=0),s.equipment[e.id]++)}),console.log(s),i.calc.TP(s)},e.formula=i,e});