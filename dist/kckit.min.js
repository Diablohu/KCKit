!function(e){var r={};function t(a){if(r[a])return r[a].exports;var i=r[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(a,i,function(r){return e[r]}.bind(null,i));return a},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=39)}([function(e,r,t){"use strict";var a=[82,88],i=[553],n=a.concat(i),s=[411,412],o=a.concat(s),u=[216,217],l=[547,146],c=u.concat(l),p=[207,208,390,391,230,231,232,233],h=[195,407],f=p.concat(h),d=[234,235,236,237],m=[437,147],g=d.concat(m),b=[238,239,240,241],y=[326,419],v=b.concat(y),S=[225,226,227,362,300,228,316,322,317,556,320,557,312,558,313,329,354,355,294,301],C=[566,567,568],A=S.concat(C),R=[542,543],B=[229],_=R.concat(B);e.exports={BB_KongouClass2ndRemodel:[149,150,151,152],BB_IseClassRemodel:a,BB_IseClass2ndRemodel:i,BB_IseClassRemodelAll:n,BB_FusouClass2ndRemodel:s,BB_IseClassRemodel_PLUS_FusouClass2ndRemodel:o,CL_KumaClassRemodel:u,CL_KumaClass2ndRemodel:l,CL_KumaClassRemodelAll:c,CL_NagaraClass2ndRemodel:[488],DD_FubukiClass2ndRemodel:[426,420],DD_AyanamiClassRemodel:p,DD_AyanamiClass2ndRemodel:h,DD_AyanamiClassRemodelAll:f,DD_AkatsukiClassRemodel:d,DD_AkatsukiClass2ndRemodel:m,DD_AkatsukiClassRemodelAll:g,DD_HatsuharuClassRemodel:b,DD_HatsuharuClass2ndRemodel:y,DD_HatsuharuClassRemodelAll:v,DD_ShiratsuyuClass2ndRemodel:[497,145,498,144,469],DD_AsashioClass2ndRemodel:[463,468,199,489,490,198,464,470],DD_KagerouClassRemodel:S,DD_KagerouClass2ndRemodel:C,DD_KagerouClassRemodelAll:A,DD_YuugumoClass2ndRemodel:R,DD_YuugumoClass2ndRemodel_PLUS_ShimakazeRemodel:_,DD_ShimakazeRemodel:B}},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":a(e))&&e.id?e:isNaN(e)?void 0:KC.db.ships[parseInt(e)]}},function(e,r,t){"use strict";var a={SmallCaliber:1,SmallCaliberHigh:2,SmallCaliberHA:2,SmallCaliberAA:3,SmallCaliberAAFD:3,MediumCaliber:4,LargeCaliber:5,SuperCaliber:6,SecondaryGun:7,SecondaryGunHigh:8,SecondaryGunHA:8,SecondaryGunAA:9,SecondaryGunAAFD:9,Type3Shell:10,APShell:11,Torpedo:12,SubmarineTorpedo:13,MidgetSubmarine:14,ReconSeaplane:15,ReconSeaplaneNight:16,SeaplaneBomber:17,CarrierFighter:18,TorpedoBomber:19,DiveBomber:20,CarrierRecon:21,Autogyro:22,AntiSubPatrol:23,SmallRadar:24,LargeRadar:25,DepthCharge:26,Sonar:27,LargeSonar:28,AAGun:29,AAGunConcentrated:30,AAGunCD:30,CDMG:30,AAFireDirector:31,AAFD:31,AviationPersonnel:36,SurfaceShipPersonnel:37,LandingCraft:38,Searchlight:39,SupplyContainer:41,CommandFacility:45,LargeFlyingBoat:45,SearchlightLarge:46,SuparRadar:47,CombatRation:48,CarrierRecon2:50,SeaplaneFighter:51,AmphibiousCraft:52,LandBasedAttacker:53,Interceptor:54,JetBomberFighter:55,JetBomberFighter2:56,TransportMaterial:57,SubmarineEquipment:58,LandBasedFighter:59,CarrierFighterNight:60,TorpedoBomberNight:61,LandBasedAntiSubPatrol:62};a.MainGuns=[a.SmallCaliber,a.SmallCaliberHigh,a.SmallCaliberAA,a.MediumCaliber,a.LargeCaliber,a.SuperCaliber],a.MainCalibers=a.MainGuns,a.SmallCalibers=[a.SmallCaliber,a.SmallCaliberHigh,a.SmallCaliberAA],a.MediumCalibers=[a.MediumCaliber],a.LargeCalibers=[a.LargeCaliber,a.SuperCaliber],a.SecondaryGuns=[a.SecondaryGun,a.SecondaryGunHigh,a.SecondaryGunAA],a.HAMounts=[a.SmallCaliberHigh,a.SmallCaliberAA,a.SecondaryGunHigh,a.SecondaryGunAA],a.HAMountsAAFD=[a.SmallCaliberAA,a.SecondaryGunAA],a.APShells=[a.APShell],a.Torpedos=[a.Torpedo,a.SubmarineTorpedo],a.Seaplanes=[a.ReconSeaplane,a.ReconSeaplaneNight,a.SeaplaneBomber,a.SeaplaneFighter],a.Fighters=[a.SeaplaneBomber,a.CarrierFighter,a.CarrierFighterNight,a.TorpedoBomber,a.TorpedoBomberNight,a.DiveBomber,a.SeaplaneFighter,a.LandBasedAttacker,a.Interceptor,a.JetBomberFighter,a.JetBomberFighter2,a.LandBasedFighter],a.Interceptors=[a.Interceptor,a.LandBasedFighter],a.Recons=[a.ReconSeaplane,a.ReconSeaplaneNight,a.CarrierRecon,a.CarrierRecon2,a.LargeFlyingBoat],a.SeaplaneRecons=[a.ReconSeaplane,a.ReconSeaplaneNight],a.SeaplaneReconsAll=[a.ReconSeaplane,a.ReconSeaplaneNight,a.LargeFlyingBoat],a.SeaplaneBombers=[a.SeaplaneBomber,a.SeaplaneFighter],a.SeaplaneFighters=[a.SeaplaneFighter],a.CarrierFighters=[a.CarrierFighter,a.CarrierFighterNight],a.CarrierRecons=[a.CarrierRecon,a.CarrierRecon2],a.CarrierBased=[a.CarrierFighter,a.CarrierFighterNight,a.TorpedoBomber,a.TorpedoBomberNight,a.DiveBomber,a.CarrierRecon,a.CarrierRecon2,a.JetBomberFighter,a.JetBomberFighter2],a.LandBased=[a.LandBasedAttacker,a.Interceptor,a.JetBomberFighter,a.JetBomberFighter2,a.LandBasedFighter,a.LandBasedAntiSubPatrol],a.TorpedoBombers=[a.TorpedoBomber,a.TorpedoBomberNight],a.DiveBombers=[a.DiveBomber],a.JetBomberFighters=[a.JetBomberFighter,a.JetBomberFighter2],a.Jets=[a.JetBomberFighter,a.JetBomberFighter2],a.Autogyros=[a.Autogyro],a.AntiSubPatrols=[a.AntiSubPatrol,a.LandBasedAntiSubPatrol],a.Aircrafts=[],[].concat(a.Seaplanes).concat(a.Recons).concat(a.CarrierBased).concat(a.Autogyros).concat(a.AntiSubPatrols).concat(a.LandBased).forEach(function(e){a.Aircrafts.indexOf(e)<0&&a.Aircrafts.push(e)}),a.Radars=[a.SmallRadar,a.LargeRadar,a.SuparRadar],a.SmallRadars=[a.SmallRadar],a.LargeRadars=[a.LargeRadar,a.SuparRadar],a.AntiSubmarines=[a.DepthCharge,a.Sonar,a.LargeSonar],a.DepthCharges=[a.DepthCharge],a.Sonars=[a.Sonar,a.LargeSonar],a.AAGuns=[a.AAGun,a.AAGunConcentrated],a.AAFireDirectors=[a.AAFireDirector],a.AAFDs=a.AAFireDirectors,a.Searchlights=[a.Searchlight,a.SearchlightLarge],a.AviationPersonnels=[a.AviationPersonnel],a.SurfaceShipPersonnels=[a.SurfaceShipPersonnel],a.LandingCrafts=[a.LandingCraft,a.AmphibiousCraft],a.AmphibiousCrafts=[a.AmphibiousCraft],a.SupplyContainers=[a.SupplyContainer],a.CombatRations=[a.CombatRation],e.exports=a},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=t(6),n=t(2),s=t(4),o=s.ArrayOrItem,u=s.ArrayOrItemAll,l={isid:function(e,r){return o(r,function(r){return!isNaN(r)&&parseInt(r)===e.id})},isnotid:function(e,r){return u(r,function(r){return!isNaN(r)&&parseInt(r)!==e.id})},isname:function(e,r){return o(r,function(r){return e.isName(r)})},isnotname:function(e,r){return u(r,function(r){return!e.isName(r)})},isnameof:function(e,r){return o(r,function(r){return e.hasName(r)})},isnotnameof:function(e,r){return u(r,function(r){return!e.hasName(r)})},istype:function(e,r,t){return o(r,function(r){if(isNaN(r))return!1;if(parseInt(r)!==e.type)return!1;if("object"===(void 0===t?"undefined":a(t))&&t.hasStat){var i=!0;for(var n in t.hasStat)Array.isArray(t.hasStat[n])?(e.stat[n]<t.hasStat[n][0]&&(i=!1),e.stat[n]>t.hasStat[n][1]&&(i=!1)):e.stat[n]<t.hasStat[n]&&(i=!1);if(!i)return!1}return!0})},isnottype:function(e,r){return u(r,function(r){return!isNaN(r)&&parseInt(r)!==e.type})},isaaradar:function(e,r){return(this.istype(e,n.Radars)&&!isNaN(e.stat.aa)&&e.stat.aa>=1)===r},issurfaceradar:function(e,r){return(this.istype(e,n.Radars)&&!isNaN(e.stat.hit)&&e.stat.hit>=3)===r}};e.exports=function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("object"===(void 0===t?"undefined":a(t)))return e(r,0,0,t);if("object"===(void 0===s?"undefined":a(s)))return e(r,t,0,s);if(void 0===(r=i(r)))return!1;for(var u in o)if(void 0!==o[u]){var c=u.toLowerCase();if(["improve","improvement","star"].includes(c))return(parseInt(t||0)||0)>=parseInt(o[u]);if(l[c]){if(!l[c](r,o[u]))return!1}else if("is"===u.substr(0,2)){var p=u.substr(2);if("HAMountAAFD"===p)p="HAMountsAAFD";else if(p+"s"in n)p+="s";else if(!(p in n))return!1;var h="object"===a(o[u])&&!Array.isArray(o[u]),f=o[u]&&h?o[u]:void 0;if(!l[!0===o[u]||h?"istype":"isnottype"](r,n[p],f))return!1}}return!0}},function(e,r,t){"use strict";var a=t(12),i=t(11);e.exports={ArrayOrItem:a,ArrayOrItemAll:i}},function(e,r,t){"use strict";var a=t(1),i=t(4),n=i.ArrayOrItem,s=i.ArrayOrItemAll;e.exports=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===(e=a(e)))return!1;for(var t in r)if(void 0!==r[t]&&!o[t.toLowerCase()](e,r[t]))return!1;return!0};var o={isid:function(e,r){return n(r,function(r){return!isNaN(r)&&parseInt(r)===e.id})},isnotid:function(e,r){return s(r,function(r){return!isNaN(r)&&parseInt(r)!==e.id})},isname:function(e,r){return n(r,function(r){return e.isName(r)})},isnotname:function(e,r){return s(r,function(r){return!e.isName(r)})},istype:function(e,r){return n(r,function(r){return!isNaN(r)&&parseInt(r)===e.type})},isnottype:function(e,r){return s(r,function(r){return!isNaN(r)&&parseInt(r)!==e.type})},isbattleship:function(e,r){return this.istype(e,[8,6,20,7,18])===r},isbb:function(e,r){return this.isbattleship(e,r)},iscarrier:function(e,r){return this.istype(e,[11,10,9,30,32])===r},iscv:function(e,r){return this.iscarrier(e,r)},issubmarine:function(e,r){return this.istype(e,[14,13])===r},isss:function(e,r){return this.issubmarine(e,r)},isclass:function(e,r){return n(r,function(r){return!isNaN(r)&&parseInt(r)===e.class})},isnotclass:function(e,r){return s(r,function(r){return!isNaN(r)&&parseInt(r)!==e.class})},hasslot:function(e,r){return!!Array.isArray(e.slot)&&(Array.isArray(r)?isNaN(r[0])&&!isNaN(r[1])?e.slot.length<=parseInt(r[1]):!isNaN(r[0])&&isNaN(r[1])?e.slot.length>=parseInt(r[0]):!isNaN(r[0])&&!isNaN(r[1])&&(e.slot.length>=parseInt(r[0])&&e.slot.length<=parseInt(r[1])):!isNaN(r)&&parseInt(r)===e.slot.length)},hasslotmin:function(e,r){return this.hasslot(e,[r,void 0])},hasslotmax:function(e,r){return this.hasslot(e,[void 0,r])},minlevel:function(e,r){return void 0===e.level||e.level>=r}}},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return e&&"object"===(void 0===e?"undefined":a(e))&&e.id?e:isNaN(e)?void 0:(KC.db.equipments||KC.db.items||{})[parseInt(e)]}},function(e,r,t){"use strict";e.exports=t(38)},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":a(e))&&e.id?e:isNaN(e)?void 0:KC.db.ship_types[parseInt(e)]}},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":a(e))&&e.id?e:isNaN(e)?void 0:KC.db.ship_classes[parseInt(e)]}},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var n=t(3),s=["id","name","nameof","type"];e.exports=function e(r,t,o){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("object"===(void 0===t?"undefined":a(t))&&!Array.isArray(t))return e(r,[],[],t);if("object"===(void 0===o?"undefined":a(o))&&!Array.isArray(o))return e(r,t,[],o);if(!Array.isArray(r))return e([r],t,o,u);if(Array.isArray(t)||(t=[t]),Array.isArray(o)||(o=[o]),Array.isArray(u)){var l=[].concat(function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}(r));return u.every(function(e){return l.some(function(r,a){return!!n(r,t[a],o[a],e)&&(l.splice(a,1),!0)})})}var c=function(e){if(void 0===u[e])return"continue";if(!1===u[e]){if(!r.every(function(r,a){return n(r,t[a],o[a],i({},e.replace(/^has/,"is"),u[e]))}))return{v:!1}}else if(!0===u[e]){if(!r.some(function(r,a){return n(r,t[a],o[a],i({},e.replace(/^has/,"is"),u[e]))}))return{v:!1}}else if("has"===e.substr(0,3)&&s.includes(e.substr(3).toLowerCase())){if(Array.isArray(u[e])){if(!u[e].every(function(a){return r.some(function(r,s){return n(r,t[s],o[s],i({},e.replace(/^has/,"is"),a))})}))return{v:!1}}else if(!r.some(function(r,a){return n(r,t[a],o[a],i({},e.replace(/^has/,"is"),u[e]))}))return{v:!1}}else if("has"!==e.substr(0,3)||"object"!==a(u[e])||Array.isArray(u[e])){if("has"!==e.substr(0,3)||isNaN(u[e])){if("has"===e.substr(0,3)&&Array.isArray(u[e])){var l=r.filter(function(r,a){return n(r,t[a],o[a],i({},e.replace(/^has/,"is"),!0))});if(l.length<u[e][0]||l.length>u[e][1])return{v:!1}}}else if(r.filter(function(r,a){return n(r,t[a],o[a],i({},e.replace(/^has/,"is"),!0))}).length<u[e])return{v:!1}}else{var c=Object.assign({},u[e]),p=void 0===c.count?1:c.count;if(delete c.count,r.filter(function(r,a){return n(r,t[a],o[a],i({},e.replace(/^has/,"is"),c))}).length<p)return{v:!1}}};for(var p in u){var h=c(p);switch(h){case"continue":continue;default:if("object"===(void 0===h?"undefined":a(h)))return h.v}}return!0}},function(e,r,t){"use strict";e.exports=function(e,r){return Array.isArray(e)?e.every(r):r(e)}},function(e,r,t){"use strict";e.exports=function(e,r){return Array.isArray(e)?e.some(r):r(e)}},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=t(1),n=t(6);e.exports=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return"number"!=typeof r&&"string"!=typeof r||(r=[r]),"number"!=typeof t&&"string"!=typeof t||(t=[t]),"number"!=typeof s&&"string"!=typeof s||(s=[s]),e=i(e),r=[].concat(function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}(Array(Math.max(5,e.slot.length+1)))).map(function(t,a){if(e&&!(e.slot.length<=a&&a<4))return n(r[a])||void 0}),{ship:e,equipments:r,equipmentStars:r.map(function(e,i){return"object"===a(r[i])?Math.min(10,parseInt(t[i])||0):void 0}),equipmentRanks:r.map(function(e,t){return"object"===a(r[t])?Math.min(7,parseInt(s[t])||0):void 0})}}},function(e,r,t){"use strict";var a=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=t(13),s=t(5),o=t(10),u=t(7);e.exports=function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],p=arguments[4];if("string"==typeof l)return e(r,t,void 0,void 0,l);if("string"==typeof c)return e(r,t,l,void 0,c);var h=n(r,t,l,c);r=h.ship,t=h.equipments,l=h.equipmentStars,c=h.equipmentRanks;var f={},d=u.filter(function(e){return s(r,e.ship)}),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var r in e)void 0===f[r]?f[r]=e[r]:"number"==typeof f[r]?f[r]+=e[r]:f[r]=e[r]};return d.filter(function(e){return"number"==typeof e.equipment&&t.some(function(r){return r&&r.id&&r.id==e.equipment})}).forEach(function(e){var r={};if("object"===i(e.bonusImprove)){var n=Object.keys(e.bonusImprove).sort(function(e,r){return parseInt(r)-parseInt(e)});t.forEach(function(t,a){t&&t.id&&t.id==e.equipment&&n.some(function(t){if(l[a]>=t){for(var i in e.bonusImprove[t])void 0===r[i]?r[i]=e.bonusImprove[t][i]:"number"==typeof r[i]?r[i]+=e.bonusImprove[t][i]:r[i]=e.bonusImprove[t][i];return!0}return!1})})}else{var s=0;if(t.forEach(function(r){r&&r.id&&r.id==e.equipment&&s++}),"object"===i(e.bonusCount))Object.keys(e.bonusCount).sort(function(e,r){return parseInt(r)-parseInt(e)}).some(function(t){return s>=t&&(r=a({},e.bonusCount[t]),!0)});else if("object"===i(e.bonus))for(var o in r=a({},e.bonus))r[o]="number"==typeof r[o]?r[o]*s:parseInt(r[o])}m(r)}),d.filter(function(e){return"object"===i(e.equipments)&&o(t,l,c,e.equipments)}).forEach(function(e){m(e.bonus)}),"string"==typeof p?f[p]||0:f}},function(e,r,t){"use strict";var a=t(0).CL_KumaClassRemodelAll;e.exports=[{equipment:268,ship:{isID:a},bonusCount:{1:{armor:2,evasion:7}}}]},function(e,r,t){"use strict";var a=t(0).BB_IseClass2ndRemodel;e.exports=[{equipment:61,ship:{isID:a},bonus:{fire:3,armor:1,evasion:2,range:"1"}}]},function(e,r,t){"use strict";var a=t(0).BB_IseClass2ndRemodel;e.exports=[{equipment:292,ship:{isID:a},bonus:{fire:8,aa:1,evasion:2}}]},function(e,r,t){"use strict";var a=t(0).BB_IseClass2ndRemodel;e.exports=[{equipment:291,ship:{isID:a},bonus:{fire:6,evasion:1}}]},function(e,r,t){"use strict";var a=t(0).BB_IseClass2ndRemodel;e.exports=[{equipment:100,ship:{isID:a},bonus:{fire:4}}]},function(e,r,t){"use strict";var a=t(0).BB_IseClass2ndRemodel;e.exports=[{equipment:57,ship:{isID:a},bonus:{fire:2}}]},function(e,r,t){"use strict";var a=t(0).BB_IseClass2ndRemodel;e.exports=[{equipment:111,ship:{isID:a},bonus:{fire:2}}]},function(e,r,t){"use strict";var a=t(0).BB_IseClass2ndRemodel;e.exports=[{equipment:24,ship:{isID:a},bonus:{fire:2}}]},function(e,r,t){"use strict";var a=t(0),i=a.BB_IseClassRemodel,n=a.BB_IseClass2ndRemodel,s=a.BB_FusouClass2ndRemodel;e.exports=[{equipment:237,ship:{isID:s},bonus:{fire:3}},{equipment:237,ship:{isID:i},bonus:{fire:3}},{equipment:237,ship:{isID:n},bonus:{fire:4}}]},function(e,r,t){"use strict";var a=t(0),i=a.BB_IseClass2ndRemodel,n=a.BB_IseClassRemodel_PLUS_FusouClass2ndRemodel;e.exports=[{equipment:81,ship:{isID:n},bonus:{fire:2}},{equipment:81,ship:{isID:i},bonus:{fire:3}}]},function(e,r,t){"use strict";var a=t(0),i=a.BB_IseClass2ndRemodel,n=a.BB_IseClassRemodel_PLUS_FusouClass2ndRemodel;e.exports=[{equipment:79,ship:{isID:n},bonus:{fire:2}},{equipment:79,ship:{isID:i},bonus:{fire:3}}]},function(e,r,t){"use strict";var a=t(0),i=a.DD_ShiratsuyuClass2ndRemodel,n=a.DD_AsashioClass2ndRemodel,s=a.DD_KagerouClass2ndRemodel,o=a.DD_YuugumoClass2ndRemodel,u=i.concat(n,o);e.exports=[{equipment:286,ship:{isID:s},bonusImprove:{0:{torpedo:2,evasion:1},5:{torpedo:3,evasion:1},10:{fire:1,torpedo:3,evasion:1}}},{equipment:286,ship:{isID:u},bonusImprove:{0:{torpedo:2,evasion:1},10:{fire:1,torpedo:2,evasion:1}}}]},function(e,r,t){"use strict";var a=t(0).DD_KagerouClass2ndRemodel;e.exports=[{equipment:15,ship:{isID:a},bonusCount:{1:{torpedo:2},2:{torpedo:4}}}]},function(e,r,t){"use strict";var a=t(0),i=a.DD_FubukiClass2ndRemodel,n=a.DD_AyanamiClass2ndRemodel,s=a.DD_AkatsukiClass2ndRemodel,o=a.DD_HatsuharuClass2ndRemodel,u=i.concat(n,s,o);e.exports=[{equipment:285,ship:{isID:u},bonusImprove:{0:{torpedo:2,evasion:1},10:{fire:1,torpedo:2,evasion:1}}}]},function(e,r,t){"use strict";var a=t(0),i=a.BB_IseClassRemodel,n=a.BB_IseClass2ndRemodel,s=a.BB_IseClassRemodelAll,o=a.BB_FusouClass2ndRemodel;e.exports=[{equipment:290,ship:{isID:o},bonus:{fire:1}},{equipment:290,ship:{isID:i},bonus:{fire:2,aa:2,evasion:1}},{equipment:290,ship:{isID:n},bonus:{fire:3,aa:2,evasion:1}},{list:[290,"AARadar"],equipments:{hasID:[290],hasAARadar:!0},ship:{isID:s},bonus:{aa:2,evasion:3}}]},function(e,r,t){"use strict";e.exports=[{equipment:289,ship:{isID:[149]},bonus:{fire:2,aa:1}},{equipment:289,ship:{isID:[151]},bonus:{fire:2,aa:2,evasion:2}},{equipment:289,ship:{isID:[150,152]},bonus:{fire:1}},{list:[289,"SurfaceRadar"],equipments:{hasID:[289],hasSurfaceRadar:!0},ship:{isID:[149,151]},bonus:{fire:2,evasion:2}}]},function(e,r,t){"use strict";e.exports=[{equipment:104,ship:{isID:[149]},bonus:{fire:2}},{equipment:104,ship:{isID:[151]},bonus:{fire:2,aa:1,evasion:2}},{equipment:104,ship:{isID:[150,152]},bonus:{fire:1}}]},function(e,r,t){"use strict";var a=t(0),i=a.DD_KagerouClass2ndRemodel,n=a.DD_YuugumoClass2ndRemodel,s=a.DD_ShimakazeRemodel;e.exports=[{equipment:267,ship:{isClass:[21],isNotID:i},bonus:{fire:1,evasion:1}},{equipment:267,ship:{isClass:[22,24],isNotID:n},bonus:{fire:2,evasion:1}},{equipment:267,ship:{isID:i},bonusCount:{1:{fire:2,evasion:1},2:{fire:3,evasion:2},3:{fire:4,evasion:3}}},{equipment:267,ship:{isID:n},bonus:{fire:3,evasion:1}},{list:[267,"SurfaceRadar"],equipments:{hasID:[267],hasSurfaceRadar:!0},ship:{isID:s},bonus:{fire:1,torpedo:3,evasion:2}},{list:[267,"SurfaceRadar"],equipments:{hasID:[267],hasSurfaceRadar:!0},ship:{isID:n},bonus:{fire:3,torpedo:4,evasion:3}}]},function(e,r,t){"use strict";var a=t(0).DD_KagerouClass2ndRemodel,i=[145,228,557],n=a.concat(i);e.exports=[{equipment:266,ship:{isClass:[19,20,21],isNotID:n},bonus:{fire:1}},{equipment:266,ship:{isID:i},bonus:{fire:1,evasion:1}},{equipment:266,ship:{isID:a},bonusCount:{1:{fire:2},2:{fire:5},3:{fire:6}}},{list:[266,"SurfaceRadar"],equipments:{hasID:[266],hasSurfaceRadar:!0},ship:{isClass:[19,20]},bonus:{fire:1,torpedo:3,evasion:1}},{list:[266,"SurfaceRadar"],equipments:{hasID:[266],hasSurfaceRadar:!0},ship:{isClass:[21]},bonus:{fire:2,torpedo:3,evasion:1}}]},function(e,r,t){"use strict";var a=t(0),i=a.DD_AyanamiClassRemodelAll,n=a.DD_AkatsukiClassRemodelAll,s=a.DD_HatsuharuClassRemodelAll;e.exports=[{equipment:63,ship:{isID:i.concat(n).concat(s)},bonus:{aa:1}},{equipment:63,ship:{isID:[242,497,498]},bonus:{evasion:1}},{equipment:63,ship:{isID:[145]},bonus:{fire:1}},{equipment:63,ship:{isID:[469]},bonus:{evasion:2}},{equipment:63,ship:{isID:[144]},bonus:{fire:1,torpedo:1,aa:1,evasion:2}}]},function(e,r,t){"use strict";var a=t(0).DD_FubukiClass2ndRemodel;e.exports=[{equipment:294,ship:{isID:a},bonus:{fire:1}},{list:[294,"SurfaceRadar"],equipments:{hasID:[294],hasSurfaceRadar:!0},ship:{isID:a},bonus:{fire:3,torpedo:1,evasion:2}},{list:[294,[125,285]],equipments:[{isID:294},{isID:[125,285]}],ship:{isID:a},bonus:{fire:1,torpedo:3}},{list:[294,[125,285],[125,285]],equipments:[{isID:294},{isID:[125,285]},{isID:[125,285]}],ship:{isID:a},bonus:{torpedo:2}}]},function(e,r,t){"use strict";var a=t(0).CL_NagaraClass2ndRemodel;e.exports=[{equipment:229,ship:{isType:[31]},bonusImprove:{10:{fire:1,aa:1}}},{equipment:229,ship:{isClass:[84,12]},bonusImprove:{10:{fire:1,aa:1}}},{equipment:229,ship:{isID:a},bonusImprove:{10:{fire:2,aa:3}}},{list:[{id:229,star:10},"SurfaceRadar"],equipments:[{isID:229,improvement:10},{isSurfaceRadar:!0}],ship:{isType:[31]},bonus:{fire:1,evasion:4}},{list:[{id:229,star:10},"SurfaceRadar"],equipments:[{isID:229,improvement:10},{isSurfaceRadar:!0}],ship:{isClass:[84,12]},bonus:{fire:2,evasion:3}},{list:[{id:229,star:10},"SurfaceRadar"],equipments:[{isID:229,improvement:10},{isSurfaceRadar:!0}],ship:{isID:a},bonus:{fire:3,evasion:2}}]},function(e,r,t){"use strict";e.exports=[{equipment:293,ship:{isType:[31]},bonus:{fire:1,aa:1,evasion:2}},{equipment:293,ship:{isClass:[84,12]},bonus:{fire:2,aa:1,evasion:3}}]},function(e,r,t){"use strict";function a(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}e.exports=[].concat(a(t(37)),a(t(36)),a(t(35)),a(t(34)),a(t(33)),a(t(32)),a(t(31)),a(t(30)),a(t(29)),a(t(28)),a(t(27)),a(t(26)),a(t(25)),a(t(24)),a(t(23)),a(t(22)),a(t(21)),a(t(20)),a(t(19)),a(t(18)),a(t(17)),a(t(16)),a(t(15)))},function(e,r,t){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(r,t,a){return t&&e(r.prototype,t),a&&e(r,a),r}}();function n(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function s(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}window.KC=function(){var e=t(7),r=t(14),u=t(5),l=t(3),c=t(1),p=t(9),h=t(8),f=t(2),d={lang:"zh_cn",joint:"・",maxShipLv:165,maxHqLv:120,db:{},path:{db:"/kcdb/",pics:{ships:"/kcpic/ships/"}},statSpeed:{5:"低速",10:"高速",15:"高速+",20:"最速"},getStatSpeed:function(e){return this.statSpeed[parseInt(e)]},statRange:{1:"短",2:"中",3:"长",4:"超长"},getStatRange:function(e){return this.statRange[parseInt(e)]},textRank:{1:"|",2:"||",3:"|||",4:"\\",5:"\\\\",6:"\\\\\\",7:"》"},check:{ship:u,equipment:l}},m=function(){function e(r){for(var t in o(this,e),r)this[t]=r[t]}return i(e,[{key:"getName",value:function(e){return e=e||d.lang,this.name?this.name[e]||this.name:null}},{key:"isName",value:function(e,r){if(!0===r&&(r=d.lang),r)return this.name[r]===e;for(var t in this.name)if("suffix"!==t&&this.name[t]===e)return!0;return!1}},{key:"hasName",value:function(e,r){if(!0===r&&(r=d.lang),r)return!!this.name[r].includes(e);for(var t in this.name)if("suffix"!==t&&this.name[t].includes(e))return!0;return!1}},{key:"isNameOf",value:function(){return this.hasName.apply(this,arguments)}},{key:"_name",get:function(){return this.getName()}}]),e}(),g=function(e){function r(e){return o(this,r),n(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}return s(r,e),r}(m),b=function(r){function t(e){o(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(r,"rankupgradable",{value:r.isRankUpgradable()}),r}return s(t,r),i(t,[{key:"getName",value:function(e,r){r=r||d.lang;var t=m.prototype.getName.call(this,r),a=e&&1==!e?e:"small";return e?t.replace(/（([^（^）]+)）/g,"<"+a+">($1)</"+a+">"):t}},{key:"getType",value:function(e){return e=e||d.lang,this.type?d.db.item_types[this.type].name[e]:null}},{key:"getIconId",value:function(){return Array.isArray(this.type_ingame)&&this.type_ingame.length>3?this.type_ingame[3]:d.db.item_types[this.type].icon}},{key:"getCaliber",value:function(){var e=this.getName(!1,"ja_jp"),r=parseFloat(e);return r}},{key:"getPower",value:function(){return this.stat[d.db.item_types[this.type].main_attribute||"fire"]}},{key:"isEquipableExSlot",value:function(){return this.equipable_exslot?this.equipable_exslot||!1:this.type&&d.db.item_types[this.type].equipable_exslot||!1}},{key:"isRankUpgradable",value:function(){return R.equipmentType.Aircrafts.includes(this.type)&&this.type!==R.equipmentType.Autogyro&&this.type!==R.equipmentType.AntiSubPatrol}},{key:"getStat",value:function(e,r){e=e.toLowerCase();var t=this.stat[e];if(!r||void 0===t||!Array.isArray(this.stat_bonus))return t;if(r&&Array.isArray(this.stat_bonus)){"object"!==(void 0===r?"undefined":a(r))&&(r=d.db.ships[r]);var i=r.id,n=void 0;if(this.stat_bonus.forEach(function(e){Array.isArray(e.ships)&&e.ships.some(function(r){if(r==i){for(var t in e.bonus)n||(n={}),n[t]=Math.max(e.bonus[t],n[t]||0);return!0}return!1}),Array.isArray(e.ship_classes)&&e.ship_classes.some(function(t){if(t==r.class){for(var a in e.bonus)n||(n={}),n[a]=Math.max(e.bonus[a],n[a]||0);return!0}return!1})}),n)return t+(n[e]||0)}return t}},{key:"getBonuses",value:function(){var r=this;return e.filter(function(e){if(e.equipment==r.id)return!0;if(void 0!==e.equipments&&"object"===a(e.ship)){if(Array.isArray(e.ship.isID)&&!e.ship.isID.every(function(e){return c(e).canEquip(r)}))return!1;if("number"==typeof e.ship.isID&&!c(e.ship.isID).canEquip(r))return!1;if(Array.isArray(e.ship.isType)&&!e.ship.isType.every(function(e){return h(e).equipable.includes(r.type)}))return!1;if("number"==typeof e.ship.isType&&!h(e.ship.isType).equipable.includes(r.type))return!1;if(Array.isArray(e.ship.isClass)&&!e.ship.isClass.every(function(e){return h(p(e).ship_type_id).equipable.includes(r.type)}))return!1;if("number"==typeof e.ship.isClass&&!h(p(e.ship.isClass).ship_type_id).equipable.includes(r.type))return!1}return Array.isArray(e.equipments)?e.equipments.some(function(e){return l(r,10,7,e)}):"object"===a(e.equipments)&&Object.keys(e.equipments).filter(function(e){return/^has/.test(e)}).some(function(t){return l(r,function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}({},t.replace(/^has/,"is"),e.equipments[t]))})})}},{key:"_icon",get:function(){return"assets/images/itemicon/"+this.getIconId()+".png"}}]),t}(m),y=function(r){function t(e){return o(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return s(t,r),i(t,[{key:"getName",value:function(e,r){e=e||"",r=r||d.lang;var t=this.getSuffix(r);return(this.name[r]||this.name.ja_jp)+(t?(!0===e?d.joint:e)+t:"")}},{key:"getNameNoSuffix",value:function(e){return e=e||d.lang,this.name[e]||this.name.ja_jp}},{key:"getSuffix",value:function(e){return e=e||d.lang,this.name.suffix&&(d.db.ship_namesuffix[this.name.suffix][e]||d.db.ship_namesuffix[this.name.suffix].ja_jp)||""}},{key:"getType",value:function(e){return e=e||d.lang,this.type?d.db.ship_types[this.type].name[e]||d.db.ship_types[this.type].name.ja_jp||"":null}},{key:"getSeriesData",value:function(){return this.series?d.db.ship_series[this.series].ships:[{id:this.id}]}},{key:"getPic",value:function(e,r){var t=this.getSeriesData();e=parseInt(e||0);for(var a=function(e,t){return"undefined"!=typeof node&&node&&node.path&&d.path.pics.ships?node.path.join(d.path.pics.ships,e+"/"+t+"."+(r||"webp")):d.path.pics.ships?d.path.pics.ships+e+"/"+t+"."+(r||"png"):"/"+e+"/"+t+"."+(r||"png")},i=0;i<t.length;i++)if(t[i].id==this.id)switch(e){case 0:case 1:case 2:case 3:case 12:case 13:case 14:return a(this.id,e);default:return t[i].illust_delete?a(t[i-1].id,e):a(this.id,e)}}},{key:"getSpeed",value:function(){return d.statSpeed[parseInt(this.stat.speed)]}},{key:"getSpeedRule",value:function(){return this.speed_rule?this.speed_rule:this.class?d.db.ship_classes[this.class].speed_rule:null}},{key:"getRange",value:function(){return d.statRange[parseInt(this.stat.range)]}},{key:"getEquipmentTypes",value:function(e){var r=this.additional_disable_item_types||[],t=d.db.ship_types[this.type],a=t.equipable.concat(this.additional_item_types||[]);return"number"==typeof e&&Array.isArray(t.additional_item_types_by_slot)&&Array.isArray(t.additional_item_types_by_slot[e])&&t.additional_item_types_by_slot[e].forEach(function(e){return a.push(e)}),a.filter(function(e){return r.indexOf(e)<0}).sort(function(e,r){return e-r})}},{key:"getAttribute",value:function(e,r){(r=r||1)>t.lvlMax&&(r=t.lvlMax);var a=void 0;switch(e){case"hp":return a=this.stat.hp,r>99&&(a=this.stat.hp>=90?this.stat.hp+9:this.stat.hp>=70?this.stat.hp+8:this.stat.hp>=50?this.stat.hp+7:this.stat.hp>=40?this.stat.hp+6:this.stat.hp>=30?this.stat.hp+5:this.stat.hp+4)>this.stat.hp_max&&(a=this.stat.hp_max),a;case"speed":return d.getStatSpeed(this.stat.speed);case"range":return d.getStatRange(this.stat.range);case"luck":return r>99?this.stat.luck+3:this.stat.luck;case"fuel":case"ammo":return r>99?Math.floor(.85*this.consum[e]):this.consum[e];case"aa":case"armor":case"fire":case"torpedo":return this.stat[e+"_max"]||this.stat[e];default:return function(e,r,t){return e=e||1,r=parseFloat(r),t=parseFloat(t)||r,r<0||t<0?-1:r==t?t:Math.floor(r+(t-r)*e/99)}(r,this.stat[e],this.stat[e+"_max"])}}},{key:"getRel",value:function(e){if(e){if(!this.rels[e]&&this.remodel&&this.remodel.prev)for(var r=d.db.ships[this.remodel.prev];r;){if(r.rels&&r.rels[e])return r.rels[e];r=r.remodel&&r.remodel.prev?d.db.ships[r.remodel.prev]:null}return this.rels[e]}return this.rels}},{key:"getCV",value:function(e){var r=this.getRel("cv");if(r)return d.db.entities[r].getName(e||d.lang)}},{key:"getIllustrator",value:function(e){var r=this.getRel("illustrator");if(r)return d.db.entities[r].getName(e||d.lang)}},{key:"getMinLv",value:function(){var e=this,r=this._series,t=void 0;return r.some(function(a,i){return e.id==a.id&&(t=i?r[i-1].next_lvl:1),t}),t}},{key:"getNavy",value:function(){return this.navy?this.navy:this.class&&d.db.ship_classes[this.class].navy||"ijn"}},{key:"getCapability",value:function(e){return e?this.capabilities?this.capabilities[e]:void 0:this.capabilities||{}}},{key:"getStatExtraMax",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(e.toLowerCase()){case"hp":var t=this.getAttribute(e,r),a=this.stat.hp_max;return Math.max(0,Math.min(2,a-t));case"asw":return this.stat.asw?9:!!R.shipType.LightCruisers.concat(R.shipType.Destroyers).includes(this.type)&&9;default:return!1}}},{key:"canEquip",value:function(e,r){var t=this;if(Array.isArray(e))return e.every(function(e){return t.canEquip(e,r)});if("string"==typeof e){if(Array.isArray(f[e]))return f[e].some(function(e){return t.canEquip(e,r)});if("number"==typeof f[e])return this.canEquip(f[e],r);if(Array.isArray(f[e+"s"]))return f[e+"s"].some(function(e){return t.canEquip(e,r)})}return"object"===(void 0===e?"undefined":a(e))&&void 0!==e.type&&(e=e.type),!isNaN(e)&&this.getEquipmentTypes(r).includes(parseInt(e))}},{key:"getBonuses",value:function(){var r=this;return e.filter(function(e){return u(r,e.ship)})}},{key:"_type",get:function(){return this.getType()}},{key:"_series",get:function(){return this.getSeriesData()}},{key:"_pics",get:function(){for(var e=[],r=0;r<15;r++)e.push(this.getPic(r));return e}},{key:"_speed",get:function(){return this.getSpeed()}},{key:"_speedRule",get:function(){return this.getSpeedRule()}},{key:"_range",get:function(){return this.getRange()}},{key:"_cv",get:function(){return this.getCV()}},{key:"_illustrator",get:function(){return this.getIllustrator()}},{key:"_minLv",get:function(){return this.getMinLv()}},{key:"_navy",get:function(){return this.getNavy()}}]),t}(m);y.lvlMax=d.maxShipLv;var v=function(e){function r(e){return o(this,r),n(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}return s(r,e),r}(m);d.dbLoad=function(e){return"string"==typeof e?d.dbLoad({type:e}):e.type||e.url?$.ajax({url:e.url||d.path.db+"/"+e.type+".json",dataType:"text",success:function(r){var t=[];e.beforeProcess&&(t=e.beforeProcess(r)),void 0===d.db[e.type]&&(d.db[e.type]={}),t.forEach(function(r){if(r){var t=JSON.parse(r);switch(e.type){case"ships":d.db[e.type][t.id]=new y(t);break;case"items":d.db[e.type][t.id]=new b(t);break;case"entities":d.db[e.type][t.id]=new g(t);break;default:d.db[e.type][t.id]=t}}}),e.success&&e.success(r)},complete:function(r,t){e.complete&&e.complete(r,t)}}):null};var S=function(e){return e instanceof y?e:d.db.ships?d.db.ships[e]:{}},C=function(e){return e instanceof b?e:d.db.equipments?d.db.equipments[e]:d.db.items[e]},A=function(e){var r=[];return e.forEach(function(e,t){r[t>=4?t+1:t]=e}),r[4]=0,r},R={equipmentType:{SmallCaliber:1,SmallCaliberHigh:2,SmallCaliberAA:3,MediumCaliber:4,LargeCaliber:5,SuperCaliber:6,SecondaryGun:7,SecondaryGunHigh:8,SecondaryGunAA:9,APShell:11,Torpedo:12,SubmarineTorpedo:13,MidgetSubmarine:14,ReconSeaplane:15,ReconSeaplaneNight:16,SeaplaneBomber:17,CarrierFighter:18,TorpedoBomber:19,DiveBomber:20,CarrierRecon:21,Autogyro:22,AntiSubPatrol:23,SmallRadar:24,LargeRadar:25,DepthCharge:26,Sonar:27,LargeSonar:28,AAGun:29,AAGunConcentrated:30,AAFireDirector:31,AviationPersonnel:36,SurfaceShipPersonnel:37,LandingCraft:38,Searchlight:39,CommandFacility:45,LargeFlyingBoat:45,SearchlightLarge:46,SuparRadar:47,CarrierRecon2:50,SeaplaneFighter:51,AmphibiousCraft:52,LandBasedAttacker:53,Interceptor:54,JetBomberFighter:55,JetBomberFighter2:56,TransportMaterial:57,SubmarineEquipment:58,LandBasedFighter:59,CarrierFighterNight:60,TorpedoBomberNight:61,LandBasedAntiSubPatrol:62},shipType:{Carriers:[9,10,11,30,32],LightCruisers:[2,3,21,28],Destroyers:[1,19],Submarines:[13,14]},calcByShip:{},calcByFleet:{},calcByField:{},calc:{}},B=R.equipmentType;return B.MainGuns=[B.SmallCaliber,B.SmallCaliberHigh,B.SmallCaliberAA,B.MediumCaliber,B.LargeCaliber,B.SuperCaliber],B.SmallCalibers=[B.SmallCaliber,B.SmallCaliberHigh,B.SmallCaliberAA],B.MediumCalibers=[B.MediumCaliber],B.LargeCalibers=[B.LargeCaliber,B.SuperCaliber],B.SecondaryGuns=[B.SecondaryGun,B.SecondaryGunHigh,B.SecondaryGunAA],B.APShells=[B.APShell],B.Torpedos=[B.Torpedo,B.SubmarineTorpedo],B.Seaplanes=[B.ReconSeaplane,B.ReconSeaplaneNight,B.SeaplaneBomber,B.SeaplaneFighter],B.Fighters=[B.SeaplaneBomber,B.CarrierFighter,B.CarrierFighterNight,B.TorpedoBomber,B.TorpedoBomberNight,B.DiveBomber,B.SeaplaneFighter,B.LandBasedAttacker,B.Interceptor,B.JetBomberFighter,B.JetBomberFighter2,B.LandBasedFighter],B.Interceptors=[B.Interceptor,B.LandBasedFighter],B.Recons=[B.ReconSeaplane,B.ReconSeaplaneNight,B.CarrierRecon,B.CarrierRecon2,B.LargeFlyingBoat],B.ReconSeaplanes=[B.ReconSeaplane,B.ReconSeaplaneNight],B.SeaplaneRecons=[B.ReconSeaplane,B.ReconSeaplaneNight,B.LargeFlyingBoat],B.SeaplaneBombers=[B.SeaplaneBomber,B.SeaplaneFighter],B.SeaplaneFighters=[B.SeaplaneFighter],B.CarrierFighters=[B.CarrierFighter,B.CarrierFighterNight],B.CarrierRecons=[B.CarrierRecon,B.CarrierRecon2],B.CarrierBased=[B.CarrierFighter,B.CarrierFighterNight,B.TorpedoBomber,B.TorpedoBomberNight,B.DiveBomber,B.CarrierRecon,B.CarrierRecon2,B.JetBomberFighter,B.JetBomberFighter2],B.LandBased=[B.LandBasedAttacker,B.Interceptor,B.JetBomberFighter,B.JetBomberFighter2,B.LandBasedFighter,B.LandBasedAntiSubPatrol],B.TorpedoBombers=[B.TorpedoBomber,B.TorpedoBomberNight],B.DiveBombers=[B.DiveBomber],B.JetBomberFighters=[B.JetBomberFighter,B.JetBomberFighter2],B.Autogyros=[B.Autogyro],B.AntiSubPatrols=[B.AntiSubPatrol,B.LandBasedAntiSubPatrol],B.Aircrafts=[],[].concat(B.Seaplanes).concat(B.Recons).concat(B.CarrierBased).concat(B.Autogyros).concat(B.AntiSubPatrols).concat(B.LandBased).forEach(function(e){B.Aircrafts.indexOf(e)<0&&B.Aircrafts.push(e)}),B.Radars=[B.SmallRadar,B.LargeRadar,B.SuparRadar],B.SmallRadars=[B.SmallRadar],B.LargeRadars=[B.LargeRadar,B.SuparRadar],B.AntiSubmarines=[B.DepthCharge,B.Sonar,B.LargeSonar],B.DepthCharges=[B.DepthCharge],B.Sonars=[B.Sonar,B.LargeSonar],B.AAGuns=[B.AAGun,B.AAGunConcentrated],B.AAFireDirectors=[B.AAFireDirector],B.Searchlights=[B.Searchlight,B.SearchlightLarge],B.AviationPersonnels=[B.AviationPersonnel],B.SurfaceShipPersonnels=[B.SurfaceShipPersonnel],B.LandingCrafts=[B.LandingCraft,B.AmphibiousCraft],B.AmphibiousCrafts=[B.AmphibiousCraft],B.isInterceptor=function(e){return(!(e=C(e)).type_ingame||47!=e.type_ingame[2])&&B.Interceptors.indexOf(e.type)>-1},R.starMultiper={SmallCalibers:{shelling:1,night:1},MediumCalibers:{shelling:1,night:1},LargeCalibers:{shelling:1.5,night:1},SecondaryGuns:{shelling:1,night:1,hit:1},APShells:{shelling:1,night:1},AAFireDirectors:{shelling:1,night:1},Searchlights:{shelling:1,night:1},AAGuns:{shelling:1,torpedo:1.2},Torpedos:{torpedo:1.2,night:1},DepthCharges:{shelling:.75,antisub:1},Sonars:{shelling:.75,antisub:1},SmallRadars:{los:1.25},LargeRadars:{los:1.4},Seaplanes:{},ReconSeaplanes:{los:1.2},SeaplaneFighters:{fighter:.2},SeaplaneBomber:{los:1.15},CarrierFighters:{fighter:.2},DiveBombers:{fighter:.25,night:1},CarrierRecons:{los:1.2},LandingCrafts:{shelling:1,night:1},Interceptors:{fighter:.2},_10:{shelling:["multiplication",.2],night:1},_66:{shelling:["multiplication",.2],night:1},_220:{shelling:["multiplication",.2],night:1},_275:{shelling:["multiplication",.2],night:1},_12:{shelling:["multiplication",.3],night:["multiplication",.3]},_234:{shelling:["multiplication",.3],night:["multiplication",.3]}},R.getStarMultiplier=function(e,r){if(!R.starMultiper._init){var t=function(e){B[e]&&B[e].forEach?B[e].forEach(function(r){R.starMultiper[r]=R.starMultiper[e]}):"number"==typeof B[e]&&(R.starMultiper[B[e]]=R.starMultiper[e])};for(var a in R.starMultiper)t(a);R.starMultiper._init=!0}var i=R.starMultiper[e]||{};return r?i[r]||0:i},R.getStarBonus=function(e,r,t){e=C(e);var a=Object.assign({},R.getStarMultiplier(e.type),R.starMultiper["_"+e.id])[r],i=void 0===a?0:a,n="sqrt";switch(Array.isArray(i)&&(n=i[0],i=i[1]),n){case"sqrt":return i*Math.sqrt(t);case"multiplication":case"multiple":return i*t}},R.getFighterPowerRankMultiper=function(e,r){e=C(e);var t=[],a={};t[0]=[0,9],t[1]=[10,24],t[2]=[25,39],t[3]=[40,54],t[4]=[55,69],t[5]=[70,84],t[6]=[85,99],t[7]=[100,120],a.CarrierFighter=[0,0,2,5,9,14,14,22],a.SeaplaneBomber=[0,0,1,1,1,3,3,6];var i=t[r],n=0;switch(e.type){case B.CarrierFighter:case B.CarrierFighterNight:case B.Interceptor:case B.SeaplaneFighter:case B.LandBasedFighter:n=a.CarrierFighter[r];break;case B.SeaplaneBomber:n=a.SeaplaneBomber[r]}return{min:Math.sqrt(i[0]/10)+n,max:Math.sqrt(i[1]/10)+n}},R.calculate=function(e,t,a,i,n,s){if(!e||!t)return 0;t instanceof y||(t=d.db.ships[t]);var o=0,u={main:0,secondary:0,torpedo:0,torpedoLateModel:0,seaplane:0,apshell:0,radar:0,radarAA:0,radarSurface:0,submarineEquipment:0,carrierFighterNight:0,torpedoBomberNight:0,aviationPersonnelNight:0,surfaceShipPersonnel:0},l=A(t.slot),c=0;a=a.map(function(e){return e?e instanceof b?e:d.db.equipments?d.db.equipments[e]:d.db.items[e]:null})||[],i=i||[],n=n||[],s=s||{},a.forEach(function(e){e&&(B.MainGuns.indexOf(e.type)>-1?u.main+=1:B.SecondaryGuns.indexOf(e.type)>-1?u.secondary+=1:B.Torpedos.indexOf(e.type)>-1?(u.torpedo+=1,e.name.ja_jp.indexOf("後期型")>-1&&(u.torpedoLateModel+=1)):B.Seaplanes.indexOf(e.type)>-1?u.seaplane+=1:B.APShells.indexOf(e.type)>-1?u.apshell+=1:B.Radars.indexOf(e.type)>-1?(u.radar+=1,e.stat.aa&&(u.radarAA+=1),e.stat.hit&&e.stat.hit>=3&&(u.radarSurface+=1)):B.SubmarineEquipment==e.type?u.submarineEquipment+=1:B.AviationPersonnels.indexOf(e.type)>-1?e.name.ja_jp.indexOf("夜間")>-1&&(u.aviationPersonnelNight+=1):B.SurfaceShipPersonnels.indexOf(e.type)>-1&&(u.surfaceShipPersonnel+=1),e.type_ingame&&(45===e.type_ingame[3]?u.carrierFighterNight+=1:46===e.type_ingame[3]&&(u.torpedoBomberNight+=1)))});var p=r(t,a,i,n);switch(e){case"fighterPower":return c=0,l.map(function(e,r){if(a[r]&&B.Fighters.indexOf(a[r].type)>-1&&e){if(c=Math.sqrt(e)*(a[r].getStat("aa",t)||0),B.CarrierFighters.includes(a[r].type))switch(n[r]){case 1:case"1":c+=1;break;case 2:case"2":c+=4;break;case 3:case"3":c+=6;break;case 4:case"4":c+=11;break;case 5:case"5":c+=16;break;case 6:case"6":c+=17;break;case 7:case"7":c+=25}else if(-1==B.Recons.indexOf(a[r].type)){var i=a[r].type==B.SeaplaneBomber?9:3;c+=1==n[r]?1:i/6*(n[r]-1)}o+=Math.floor(c)}}),o;case"fighterPower_v2":return R.calcByShip.fighterPower_v2(t,a,i,n);case"shelling":case"shellingDamage":return R.shipType.Submarines.indexOf(t.type)>-1?"-":(o=R.calcByShip.shellingPower(t,a,i,n,{},p))&&o>-1?Math.floor(o):"-";case"torpedo":case"torpedoDamage":return(o=function(e){return R.calcByShip.torpedoPower(t,a,i,n,e,p)}())&&o>-1?Math.floor(o):"-";case"nightBattle":var h=R.calcByShip.nightPower(t,a,i,n,{},u,p);return h.damage<=0?"-":h.value;case"addHit":return l.map(function(e,r){a[r]&&(o+=a[r].getStat("hit",t)||0)}),(o+=p.hit||0)>=0?"+"+o:o;case"addArmor":return l.map(function(e,r){a[r]&&(o+=a[r].getStat("armor",t)||0)}),o+(p.armor||0);case"addEvasion":return l.map(function(e,r){a[r]&&(o+=a[r].getStat("evasion",t)||0)}),o+(p.evasion||0);case"losPower":return R.calcByShip.losPower(t,a,i,n,s);default:return R.calcByShip[e](t,a,i,n,s,p)}},R.shellingDamage=function(e,r,t,a){return this.calculate("shellingDamage",e,r,t,a)},R.torpedoDamage=function(e,r,t,a){return this.calculate("torpedoDamage",e,r,t,a)},R.fighterPower=function(e,r,t,a){return this.calculate("fighterPower",e,r,t,a)},R.fighterPower_v2=function(e,r,t,a){return this.calculate("fighterPower_v2",e,r,t,a)},R.nightBattle=function(e,r,t,a){return this.calculate("nightBattle",e,r,t,a)},R.addHit=function(e,r,t,a){return this.calculate("addHit",e,r,t,a)},R.addArmor=function(e,r,t,a){return this.calculate("addArmor",e,r,t,a)},R.addEvasion=function(e,r,t,a){return this.calculate("addEvasion",e,r,t,a)},R.losPower=function(e,r,t,a,i){return this.calculate("losPower",e,r,t,a,i)},R.calc.losPower=function(e){var r=["(Intercept)","DiveBombers","TorpedoBombers","CarrierRecons","SeaplaneRecons","SeaplaneBombers","SmallRadars","LargeRadars","Searchlights","statLos","hqLv"],t={"(Intercept)":0,DiveBombers:1.03745043134563,TorpedoBombers:1.3679056374142,CarrierRecons:1.65940512636315,SeaplaneRecons:2,SeaplaneBombers:1.77886368594467,SmallRadars:1.0045778494921,LargeRadars:.990738063979571,Searchlights:.906965144360512,statLos:1.6841895400986,hqLv:-.614246711531445},a={"(Intercept)":4.66445565766347,DiveBombers:.0965028505325845,TorpedoBombers:.108636184978525,CarrierRecons:.0976055279516298,SeaplaneRecons:.0866229392463539,SeaplaneBombers:.0917722496848294,SmallRadars:.0492773648320346,LargeRadars:.0491221486053861,Searchlights:.0658283797225724,statLos:.0781594211213618,hqLv:.0369222352426548},i={"(Intercept)":{"(Intercept)":1,DiveBombers:-.147020064768061,TorpedoBombers:-.379236131621529,CarrierRecons:-.572858669501918,SeaplaneRecons:-.733913857017495,SeaplaneBombers:-.642621825152428,SmallRadars:-.674829588068364,LargeRadars:-.707418111752863,Searchlights:-.502304601556193,statLos:-.737374218573832,hqLv:-.05071933950163},DiveBombers:{"(Intercept)":-.147020064768061,DiveBombers:1,TorpedoBombers:.288506347076736,CarrierRecons:.365820372770994,SeaplaneRecons:.425744409856409,SeaplaneBombers:.417783698791503,SmallRadars:.409046013184429,LargeRadars:.413855653833994,Searchlights:.308730607324667,statLos:.317984916914851,hqLv:-.386740224500626},TorpedoBombers:{"(Intercept)":-.379236131621529,DiveBombers:.288506347076736,TorpedoBombers:1,CarrierRecons:.482215071254241,SeaplaneRecons:.584455876852325,SeaplaneBombers:.558515133495825,SmallRadars:.547260012897553,LargeRadars:.560437619378443,Searchlights:.437934879351188,statLos:.533934507932748,hqLv:-.405349979885748},CarrierRecons:{"(Intercept)":-.572858669501918,DiveBombers:.365820372770994,TorpedoBombers:.482215071254241,CarrierRecons:1,SeaplaneRecons:.804494553748065,SeaplaneBombers:.75671307047535,SmallRadars:.748420581669228,LargeRadars:.767980338133817,Searchlights:.589651513349878,statLos:.743851348255527,hqLv:-.503544281376776},SeaplaneRecons:{"(Intercept)":-.733913857017495,DiveBombers:.425744409856409,TorpedoBombers:.584455876852325,CarrierRecons:.804494553748065,SeaplaneRecons:1,SeaplaneBombers:.932444440578382,SmallRadars:.923988080549326,LargeRadars:.94904944359066,Searchlights:.727912987329348,statLos:.944434077970518,hqLv:-.614921413821462},SeaplaneBombers:{"(Intercept)":-.642621825152428,DiveBombers:.417783698791503,TorpedoBombers:.558515133495825,CarrierRecons:.75671307047535,SeaplaneRecons:.932444440578382,SeaplaneBombers:1,SmallRadars:.864289865445084,LargeRadars:.886872388674911,Searchlights:.68310647756898,statLos:.88122333327317,hqLv:-.624797255805045},SmallRadars:{"(Intercept)":-.674829588068364,DiveBombers:.409046013184429,TorpedoBombers:.547260012897553,CarrierRecons:.748420581669228,SeaplaneRecons:.923988080549326,SeaplaneBombers:.864289865445084,SmallRadars:1,LargeRadars:.872011318623459,Searchlights:.671926570242336,statLos:.857213501657084,hqLv:-.560018086758868},LargeRadars:{"(Intercept)":-.707418111752863,DiveBombers:.413855653833994,TorpedoBombers:.560437619378443,CarrierRecons:.767980338133817,SeaplaneRecons:.94904944359066,SeaplaneBombers:.886872388674911,SmallRadars:.872011318623459,LargeRadars:1,Searchlights:.690102027588321,statLos:.883771367337743,hqLv:-.561336967269448},Searchlights:{"(Intercept)":-.502304601556193,DiveBombers:.308730607324667,TorpedoBombers:.437934879351188,CarrierRecons:.589651513349878,SeaplaneRecons:.727912987329348,SeaplaneBombers:.68310647756898,SmallRadars:.671926570242336,LargeRadars:.690102027588321,Searchlights:1,statLos:.723228553177704,hqLv:-.518427865593732},statLos:{"(Intercept)":-.737374218573832,DiveBombers:.317984916914851,TorpedoBombers:.533934507932748,CarrierRecons:.743851348255527,SeaplaneRecons:.944434077970518,SeaplaneBombers:.88122333327317,SmallRadars:.857213501657084,LargeRadars:.883771367337743,Searchlights:.723228553177704,statLos:1,hqLv:-.620804120587684},hqLv:{"(Intercept)":-.05071933950163,DiveBombers:-.386740224500626,TorpedoBombers:-.405349979885748,CarrierRecons:-.503544281376776,SeaplaneRecons:-.614921413821462,SeaplaneBombers:-.624797255805045,SmallRadars:-.560018086758868,LargeRadars:-.561336967269448,Searchlights:-.518427865593732,statLos:-.620804120587684,hqLv:1}},n={DiveBombers:0,TorpedoBombers:0,CarrierRecons:0,SeaplaneRecons:0,SeaplaneBombers:0,SmallRadars:0,LargeRadars:0,Searchlights:0,statLos:1,hqLv:1};for(var s in e)n[s]=e[s];return function(e){void 0===e["(Intercept)"]&&(e["(Intercept)"]=1),e.hqLv=5*Math.ceil(e.hqLv/5);var n={},s=0,o={},u=0;return r.forEach(function(r){var i=e[r]*t[r];n[r]=i,s+=i,o[r]=e[r]*a[r]}),r.forEach(function(e){r.forEach(function(r){u+=o[e]*o[r]*i[e][r]})}),{x_estimate:n,y_estimate:s,x_std_error:o,y_std_error:u}}(n)},R.calc.los33=function(e){if(e){var r=0,t=0,a={TorpedoBombers:.8,CarrierRecons:1,ReconSeaplane:1.2,ReconSeaplaneNight:1.2,SeaplaneBomber:1.1};return Object.defineProperty(a,"default",{value:.6,enumerable:!1,configurable:!1,writable:!1}),e.equipments.forEach(function(e){if(e.id){var t=C(e.id);if(t.stat.los){var i=a.default,n=e.star||0;for(var s in a)(Array.isArray(B[s])?B[s]:[B[s]]).indexOf(t.type)>-1&&(i=a[s]);r+=i*(t.stat.los+R.getStarBonus(t,"los",n))}}}),e.ships.forEach(function(e){var r=S(e.id),a=r.getAttribute("los",Math.max(e.lv||1,r.getMinLv()));t+=Math.sqrt(Math.max(a,1))}),r+t-Math.ceil(.4*e.hq)+2*(6-e.ships.length)}},R.calc.TP=function(e){var r=0,t=(e=e||{}).ship||{},a=e.equipment||{};for(var i in t){var n=0;switch(i){case 1:case"1":case 19:case"19":case"dd":n=5;break;case 2:case"2":case 28:case"28":case"cl":n=2;break;case 21:case"21":case"ct":n=6;break;case 5:case"5":case"cav":n=4;break;case 8:case"8":case"bbv":n=7;break;case 12:case"12":case 24:case"24":case"av":n=9.5;break;case 14:case"14":case"ssv":n=1;break;case 15:case"15":case"lha":n=12;break;case 29:case"29":case"ao":n=15;break;case 17:case"17":case"as":n=7}r+=n*(parseInt(t[i])||0)}for(var s in a){var o=0,u=parseInt(s),l=void 0;switch(u){case 145:case 150:o=1;break;case 75:o=5;break;case 68:case 193:case 166:o=8;break;case 167:o=2;break;default:switch((l=C(u)).type){case R.equipmentType.LandingCraft:l.name.ja_jp.indexOf("大発動艇")>-1&&(o=8)}}r+=o*(parseInt(a[s])||0)}return r},R.calc.fighterPower=function(e,r,t,a){if(!e)return[0,0];e=e instanceof b?e:d.db.equipments?d.db.equipments[e]:d.db.items[e],r=r||0,t=t||0,a=a||0;var i=[0,0];if(B.Fighters.indexOf(e.type)>-1&&r){var n=((e.stat.aa||0)+(B.isInterceptor(e)?1.5*e.stat.evasion:0)+a*R.getStarMultiplier(e.type,"fighter"))*Math.sqrt(r),s=R.getFighterPowerRankMultiper(e,t);i[0]+=Math.floor(n+s.min),i[1]+=Math.floor(n+s.max)}return i},R.calc.fighterPowerAA=function(e,r,t,a){if(!e)return[0,0];e=C(e),r=r||0,t=t||0,a=a||0;var i=[0,0];if(r){var n=((e.stat.aa||0)+(B.isInterceptor(e)?e.stat.evasion:0)+(B.isInterceptor(e)?2*e.stat.hit:0)+a*R.getStarMultiplier(e.type,"fighter"))*Math.sqrt(r),s=R.getFighterPowerRankMultiper(e,t,{isAA:!0});i[0]+=Math.floor(n+s.min),i[1]+=Math.floor(n+s.max)}return i},R.calcByShip.shellingPower=function(e,t,a,i,n,s){n=n||{},s=s||r(e,t,a,i);var o=0,u=!1,l=A(e.slot);if(R.shipType.Carriers.indexOf(e.type)>-1?u=!0:[33].includes(e.type)||t.some(function(e){if(e&&!u&&B.CarrierBased.indexOf(e.type)>-1)return u=!0,!0}),u&&!n.isNight){var c=0,p=0;return l.map(function(r,i){if(t[i]){var n=t[i];o+=1.5*n.getStat("fire",e)||0,B.TorpedoBombers.indexOf(n.type)>-1&&(c+=n.getStat("torpedo",e)||0),p+=n.getStat("bomb",e)||0,B.SecondaryGuns.indexOf(n.type)>-1&&(o+=Math.sqrt(1.5*(a[i]||0)))}}),c||p?o+=Math.floor(1.5*(Math.floor(1.3*p)+c+e.stat.fire_max+(s.fire||0)))+50:-1}o=e.stat.fire_max||0;var h={CLMainGunNaval:0,CLMainGunTwin:0,ItalianCAMainGun:0};l.map(function(r,i){if(t[i]){var s=t[i];o+=s.getStat("fire",e)||0,R.shipType.LightCruisers.indexOf(e.type)>-1&&(["14cm単装砲","15.2cm単装砲"].forEach(function(e){s.name.ja_jp.includes(e)&&(h.CLMainGunNaval+=1)}),["14cm連装砲","15.2cm連装砲"].forEach(function(e){s.name.ja_jp.includes(e)&&(h.CLMainGunTwin+=1)})),"rm"===e._navy&&s.name.ja_jp.includes("203mm/53")&&(h.ItalianCAMainGun+=1),a[i]&&!n.isNight&&(o+=R.getStarBonus(s,"shelling",a[i]))}});var f=0+2*Math.sqrt(h.CLMainGunTwin)+Math.sqrt(h.CLMainGunNaval)+Math.sqrt(h.ItalianCAMainGun)+(s.fire||0);return o+f},R.calcByShip.torpedoPower=function(e,t,a,i,n,s){n=n||{},s=s||r(e,t,a,i);var o=0,u=A(e.slot);return R.shipType.Carriers.indexOf(e.type)>-1&&!n.isNight?n.returnZero?0:-1:(o=(e.stat.torpedo_max||0)+(s.torpedo||0),u.map(function(r,i){if(t[i]){var s=t[i];o+=B.TorpedoBombers.indexOf(s.type)>-1&&!n.isNight?0:s.getStat("torpedo",e)||0,a[i]&&!n.isNight&&(o+=R.getStarBonus(s,"torpedo",a[i]))}}),o)},R.calcByShip.nightPower=function(e,t,a,i,n,s,o){n=n||{},o=o||r(e,t,a,i);var u={damage:0},l=0,c=A(e.slot);if((s.aviationPersonnelNight||e.getCapability("count_as_night_operation_aviation_personnel"))&&(s.carrierFighterNight>=1||s.torpedoBomberNight>=1)){c.forEach(function(e,r){t[r]&&a[r]&&(l+=R.getStarBonus(t[r],"night",a[r]))});var p=0,h=0,f=0,d=0,m=0,g=[],b=0,y=0;c.forEach(function(r,i){if(t[i]){var n=t[i],s=!1,o=!1;n.type_ingame&&(45===n.type_ingame[3]?(o=!0,s=!0):46===n.type_ingame[3]&&(o=!0,s=!0)),B.TorpedoBombers.indexOf(n.type)>-1?n.hasName("Swordfish","ja_jp")&&(o=!0,b++):B.DiveBombers.indexOf(n.type)>-1&&n.hasName("岩井","ja_jp")&&(o=!0,y++),s&&(p+=r),o&&(h+=n.getStat("fire",e),f+=n.getStat("torpedo",e),d+=Math.sqrt(r)*((3+1.5*(s?1:0))*(n.getStat("fire",e)+n.getStat("torpedo",e)+n.getStat("bomb",e)+n.getStat("asw",e))/10),a[i]&&(m+=R.getStarBonus(t[i],"night",a[i])))}});var v=b+y;s.carrierFighterNight>=2&&s.torpedoBomberNight>=1&&g.push(1.25),s.carrierFighterNight>=1&&s.torpedoBomberNight>=1&&g.push(1.2),(s.carrierFighterNight>=3||s.carrierFighterNight>=2&&v>=1||s.carrierFighterNight>=1&&s.torpedoBomberNight>=1&&v>=1||s.carrierFighterNight>=1&&s.torpedoBomberNight>=2||s.carrierFighterNight>=1&&v>=2)&&g.push(1.18),u.type="航空",u.hit=1,u.damage=Math.floor(e.stat.fire_max+(o.fire||0)+h+f+3*p+d+m),u.isMax=!0,g.length&&(u.cis=g.map(function(e){return[Math.floor(u.damage*e),1]}))}else if(e.getCapability("participate_night_battle_when_equip_swordfish"))u.damage+=e.stat.fire_max+(o.fire||0)+e.stat.torpedo_max+(o.torpedo||0),c.forEach(function(r,a){var i=t[a];t[a]&&B.TorpedoBombers.indexOf(i.type)>-1&&i.name.ja_jp.indexOf("Swordfish")>-1&&(u.damage+=i.getStat("fire",e)+i.getStat("torpedo",e))}),u.type="通常",u.damage=Math.floor(u.damage),u.hit=1;else{if(e.stat.fire+e.stat.torpedo<=0)return{damage:0};var S={};c.forEach(function(e,r){if(t[r]&&(a[r]&&(l+=R.getStarBonus(t[r],"night",a[r])),t[r])){var i=t[r];S[i.id]?S[i.id]++:S[i.id]=1}}),u.damage=R.calcByShip.shellingPower(e,t,a,i,{isNight:!0},o)+R.calcByShip.torpedoPower(e,t,a,i,{isNight:!0,returnZero:!0},o)+l+(o.nightExtra||0),R.shipType.Submarines.indexOf(e.type)>-1&&s.torpedoLateModel>=1&&s.submarineEquipment>=1?(u.type="雷击CI",u.damage=Math.floor(1.75*u.damage),u.hit=2):R.shipType.Submarines.indexOf(e.type)>-1&&s.torpedoLateModel>=2?(u.type="雷击CI",u.damage=Math.floor(1.6*u.damage),u.hit=2):s.torpedo>=2?(u.type="雷击CI",u.damage=Math.floor(1.5*u.damage),u.hit=2):s.main>=3?(u.type="炮击CI",u.damage=Math.floor(2*u.damage),u.hit=1):2==s.main&&s.secondary>=1?(u.type="炮击CI",u.damage=Math.floor(1.75*u.damage),u.hit=1):R.shipType.Destroyers.indexOf(e.type)>-1&&s.torpedo>=1&&s.radarSurface>=1&&s.surfaceShipPersonnel>=1?(u.type="电探CI",u.damage=Math.floor(1.25*u.damage),u.hit=1):R.shipType.Destroyers.indexOf(e.type)>-1&&s.torpedo>=1&&s.radarSurface>=1&&s.main>=1?(u.type="电雷CI",u.damage=S[267]?Math.floor(1.625*u.damage):Math.floor(1.3*u.damage),u.hit=1):s.main>=1&&1==s.torpedo?(u.type="炮雷CI",u.damage=Math.floor(1.3*u.damage),u.hit=2):2==s.main&&s.secondary<=0&&s.torpedo<=0||1==s.main&&s.secondary>=1&&s.torpedo<=0||0==s.main&&s.secondary>=2&&s.torpedo>=0?(u.type="连击",u.damage=Math.floor(1.2*u.damage),u.hit=2):(u.type="通常",u.damage=Math.floor(u.damage),u.hit=1)}var C=" ";if(u.isMax&&(C=" ≤ "),u.isMin&&(C=" ≥ "),u.value=""+u.type+C+u.damage,u.hit&&u.hit>1&&(u.value+=" x "+u.hit),Array.isArray(u.cis)&&u.cis.length)u.value+=" (CI"+C+u.cis.sort(function(e,r){return e[0]-r[0]}).map(function(e){return e[0]+(e[1]&&e[1]>1?" x "+e[1]:"")}).join(" 或 ")+")";else if(u.damage_ci){var _=u.hit_ci||u.hit||1;u.value+=" (CI"+C+u.damage_ci+")",_&&_>1&&(u.value+=" x "+_)}return u},R.calcByShip.fighterPower_v2=function(e,r,t,a){var i=[0,0];return A(e.slot).map(function(e,n){var s=R.calc.fighterPower(r[n],e,a[n]||0,t[n]||0);i[0]+=s[0],i[1]+=s[1]}),i},R.calcByShip.losPower=function(e,r,t,a,i){(i=i||{}).shipLv=i.shipLv||1,i.hqLv=i.hqLv||1,i.shipLv<0&&(i.shipLv=1),i.hqLv<0&&(i.hqLv=1);var n={DiveBombers:0,TorpedoBombers:0,CarrierRecons:0,SeaplaneRecons:0,SeaplaneBombers:0,SmallRadars:0,LargeRadars:0,Searchlights:0,statLos:Math.sqrt(e.getAttribute("los",i.shipLv)),hqLv:i.hqLv};return r.forEach(function(e){if(e)for(var r in n)B[r]&&B[r].push&&B[r].indexOf(e.type)>-1&&(n[r]+=e.stat.los)}),R.calc.losPower(n)},R.calcByShip.TP=function(e,r){if(!e||!r||!r.push)return 0;e=S(e);var t={ship:{},equipment:{}};return t.ship[e.type]=1,r.forEach(function(e){if(e){var r="number"==typeof e?e:C(e).id;t.equipment[r]||(t.equipment[r]=0),t.equipment[r]++}}),e.getCapability("count_as_landing_craft")&&(t.equipment[68]||(t.equipment[68]=0),t.equipment[68]++),R.calc.TP(t)},R.calcByShip.speed=function(e,r,t,i,n){if(!e)return"";if("object"===(void 0===t?"undefined":a(t))&&t.push)return R.calcByShip.speed(e,r,[],[],t);if("object"===(void 0===i?"undefined":a(i))&&i.push)return R.calcByShip.speed(e,r,t,[],i);e=S(e),r=r||[],n=n||{};var s=parseInt(e.stat.speed),o=function(e){return e=Math.min(20,e||s),n.returnNumber?e:d.statSpeed[e]},u={33:0,34:0,87:0},l=e._speedRule||"low-2",c=0;if(r.forEach(function(e){if(e){var r="number"==typeof e?e:C(e).id;void 0!==u[""+r]&&u[""+r]++}}),!u[33])return o();switch(l){case"low-1":c=.3*Math.min(u[34],1)+.7*u[87];break;case"low-2":case"high-3":(u[34]||u[87])&&(c=Math.min(1,u[34]/3+.5*u[87]));break;case"low-3":case"high-4":(u[34]||u[87])&&(s+=5);break;case"high-1":c=.5*u[34]+1*u[87];break;case"high-2":c=.5*u[34]+.5*u[87];break;case"low-4":c=.5}return c>0&&c<1?s+=5:c>=1&&c<1.5?s+=10:c>=1.5&&(s+=15),o()},R.calcByShip.fireRange=function(e,t,a,i,n,s){if(!e)return"-";t=t||[],n=n||{},s=s||r(e,t,a,i);var o=parseInt(e.stat.range);return t.forEach(function(e){e&&(o=Math.max(o,C(e).stat.range||0))}),isNaN(s.range)||(o+=parseInt(s.range)),d.statRange[Math.min(4,o)]},R.calcByFleet.los33=function(e,r){var t=[],a=[];return e.forEach(function(e){if(Array.isArray(e)){var r=e[0];if(r){var i=e[2],n=e[3],s=e[4];a.push({id:r,lv:e[1][0]}),i.forEach(function(e,r){t.push({id:e,star:n[r],rank:s[r]})})}}}),R.calc.los33({hq:r,equipments:t,ships:a})},R.calcByField.fighterPowerAA=function(e){var r=[0,0],t=1;function a(e){return t=Math.max(e,t)}return e.forEach(function(e){var t=C(e[0]||e.equipment||e.equipmentId),i=e[1]||e.star||0,n=e[2]||e.rank||0,s=e[3]||e.carry||0,o=R.calc.fighterPowerAA(t,s,n,i);switch(s||(s=R.equipmentType.Recons.indexOf(t.type)>-1?4:18),r[0]+=o[0],r[1]+=o[1],t.type){case B.CarrierRecon:case B.CarrierRecon2:t.stat.los<=7?a(1.2):t.stat.los>=9?a(1.3):a(1.25);break;case B.ReconSeaplane:case B.ReconSeaplaneNight:case B.LargeFlyingBoat:t.stat.los<=7?a(1.1):t.stat.los>=9?a(1.16):a(1.13)}}),r[0]=r[0]*t,r[1]=r[1]*t,r},R.getBonus=function(e,t,a,i,n){return r(e,t,a,i,n)},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,r){var t;if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),i=a.length>>>0;if(0===i)return-1;var n=+r||0;if(Math.abs(n)===1/0&&(n=0),n>=i)return-1;for(t=Math.max(n>=0?n:i-Math.abs(n),0);t<i;){if(t in a&&a[t]===e)return t;t++}return-1}),d.Entity=g,d.Equipment=b,d.Ship=y,d.Consumable=v,d.formula=R,d}()}]);