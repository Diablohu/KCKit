!function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return e&&"object"===(void 0===e?"undefined":a(e))&&e.id?e:isNaN(e)?void 0:(KC.db.equipments||KC.db.items||{})[parseInt(e)]}},function(e,t,r){"use strict";var a=r(8),n=r(7);e.exports={ArrayOrItem:a,ArrayOrItemAll:n}},function(e,t,r){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":a(e))&&e.id?e:isNaN(e)?void 0:KC.db.ships[parseInt(e)]}},function(e,t,r){"use strict";var a=[82,88],n=[216,217].concat([547,146]),i=[566,567],o=[543],s=o.concat([229]);e.exports=[{equipment:266,ship:{isID:i},bonusCount:{1:{fire:1},2:{fire:3}}},{equipment:267,ship:{isClass:[21],isNotID:i},bonus:{fire:1,evasion:1}},{equipment:267,ship:{isClass:[22,24],isNotID:o},bonus:{fire:2,evasion:1}},{equipment:267,ship:{isID:i},bonusCount:{1:{fire:2,evasion:1},2:{fire:3,evasion:2},3:{fire:4,evasion:3}}},{equipment:267,ship:{isID:o},bonus:{fire:3,evasion:1}},{equipment:104,ship:{isID:[149]},bonus:{fire:2}},{equipment:104,ship:{isID:[151]},bonus:{fire:2,aa:1,evasion:2}},{equipment:104,ship:{isID:[150,152]},bonus:{fire:1}},{equipment:289,ship:{isID:[149]},bonus:{fire:2}},{equipment:289,ship:{isID:[151]},bonus:{fire:2,aa:1,evasion:2}},{equipment:289,ship:{isID:[150,152]},bonus:{fire:1}},{equipment:290,ship:{isID:a},bonus:{fire:2,aa:2,evasion:1}},{equipment:285,ship:{isID:[].concat([426,420],[195,407],[437,147],[326,419])},bonusImprove:{0:{torpedo:2,evasion:1},10:{fire:1,torpedo:2,evasion:1}}},{equipment:15,ship:{isID:i},bonusCount:{1:{torpedo:2},2:{torpedo:4}}},{equipment:286,ship:{isID:i},bonusImprove:{0:{torpedo:2,evasion:1},5:{torpedo:3,evasion:1},10:{fire:1,torpedo:3,evasion:1}}},{equipment:286,ship:{isID:[].concat([145,498,144,469],[463,468,199,489,490,198,464,470],o)},bonusImprove:{0:{torpedo:2,evasion:1},10:{fire:1,torpedo:2,evasion:1}}},{equipment:268,ship:{isID:n},bonusCount:{1:{armor:2,evasion:7}}},{equipments:{hasId:[267],hasSurfaceRadar:!0},ship:{isID:s},bonus:{fire:1,torpedo:3,evasion:2}},{equipments:{hasId:[289],hasSurfaceRadar:!0},ship:{isID:[149,150,151,152]},bonus:{fire:2}},{equipments:{hasId:[290],hasAARadar:!0},ship:{isID:a},bonus:{aa:2,evasion:3}}]},function(e,t,r){"use strict";var a={SmallCaliber:1,SmallCaliberHigh:2,SmallCaliberHA:2,SmallCaliberAA:3,SmallCaliberAAFD:3,MediumCaliber:4,LargeCaliber:5,SuperCaliber:6,SecondaryGun:7,SecondaryGunHigh:8,SecondaryGunHA:8,SecondaryGunAA:9,SecondaryGunAAFD:9,Type3Shell:10,APShell:11,Torpedo:12,SubmarineTorpedo:13,MidgetSubmarine:14,ReconSeaplane:15,ReconSeaplaneNight:16,SeaplaneBomber:17,CarrierFighter:18,TorpedoBomber:19,DiveBomber:20,CarrierRecon:21,Autogyro:22,AntiSubPatrol:23,SmallRadar:24,LargeRadar:25,DepthCharge:26,Sonar:27,LargeSonar:28,AAGun:29,AAGunConcentrated:30,AAGunCD:30,CDMG:30,AAFireDirector:31,AAFD:31,AviationPersonnel:36,SurfaceShipPersonnel:37,LandingCraft:38,Searchlight:39,SupplyContainer:41,CommandFacility:45,LargeFlyingBoat:45,SearchlightLarge:46,SuparRadar:47,CombatRation:48,CarrierRecon2:50,SeaplaneFighter:51,AmphibiousCraft:52,LandBasedAttacker:53,Interceptor:54,JetBomberFighter:55,JetBomberFighter2:56,TransportMaterial:57,SubmarineEquipment:58,LandBasedFighter:59,CarrierFighterNight:60,TorpedoBomberNight:61,LandBasedAntiSubPatrol:62};a.MainGuns=[a.SmallCaliber,a.SmallCaliberHigh,a.SmallCaliberAA,a.MediumCaliber,a.LargeCaliber,a.SuperCaliber],a.MainCalibers=a.MainGuns,a.SmallCalibers=[a.SmallCaliber,a.SmallCaliberHigh,a.SmallCaliberAA],a.MediumCalibers=[a.MediumCaliber],a.LargeCalibers=[a.LargeCaliber,a.SuperCaliber],a.SecondaryGuns=[a.SecondaryGun,a.SecondaryGunHigh,a.SecondaryGunAA],a.HAMounts=[a.SmallCaliberHigh,a.SmallCaliberAA,a.SecondaryGunHigh,a.SecondaryGunAA],a.HAMountsAAFD=[a.SmallCaliberAA,a.SecondaryGunAA],a.APShells=[a.APShell],a.Torpedos=[a.Torpedo,a.SubmarineTorpedo],a.Seaplanes=[a.ReconSeaplane,a.ReconSeaplaneNight,a.SeaplaneBomber,a.SeaplaneFighter],a.Fighters=[a.SeaplaneBomber,a.CarrierFighter,a.CarrierFighterNight,a.TorpedoBomber,a.TorpedoBomberNight,a.DiveBomber,a.SeaplaneFighter,a.LandBasedAttacker,a.Interceptor,a.JetBomberFighter,a.JetBomberFighter2,a.LandBasedFighter],a.Interceptors=[a.Interceptor,a.LandBasedFighter],a.Recons=[a.ReconSeaplane,a.ReconSeaplaneNight,a.CarrierRecon,a.CarrierRecon2,a.LargeFlyingBoat],a.SeaplaneRecons=[a.ReconSeaplane,a.ReconSeaplaneNight],a.SeaplaneReconsAll=[a.ReconSeaplane,a.ReconSeaplaneNight,a.LargeFlyingBoat],a.SeaplaneBombers=[a.SeaplaneBomber,a.SeaplaneFighter],a.SeaplaneFighters=[a.SeaplaneFighter],a.CarrierFighters=[a.CarrierFighter,a.CarrierFighterNight],a.CarrierRecons=[a.CarrierRecon,a.CarrierRecon2],a.CarrierBased=[a.CarrierFighter,a.CarrierFighterNight,a.TorpedoBomber,a.TorpedoBomberNight,a.DiveBomber,a.CarrierRecon,a.CarrierRecon2,a.JetBomberFighter,a.JetBomberFighter2],a.LandBased=[a.LandBasedAttacker,a.Interceptor,a.JetBomberFighter,a.JetBomberFighter2,a.LandBasedFighter,a.LandBasedAntiSubPatrol],a.TorpedoBombers=[a.TorpedoBomber,a.TorpedoBomberNight],a.DiveBombers=[a.DiveBomber],a.JetBomberFighters=[a.JetBomberFighter,a.JetBomberFighter2],a.Jets=[a.JetBomberFighter,a.JetBomberFighter2],a.Autogyros=[a.Autogyro],a.AntiSubPatrols=[a.AntiSubPatrol,a.LandBasedAntiSubPatrol],a.Aircrafts=[],[].concat(a.Seaplanes).concat(a.Recons).concat(a.CarrierBased).concat(a.Autogyros).concat(a.AntiSubPatrols).concat(a.LandBased).forEach(function(e){a.Aircrafts.indexOf(e)<0&&a.Aircrafts.push(e)}),a.Radars=[a.SmallRadar,a.LargeRadar,a.SuparRadar],a.SmallRadars=[a.SmallRadar],a.LargeRadars=[a.LargeRadar,a.SuparRadar],a.AntiSubmarines=[a.DepthCharge,a.Sonar,a.LargeSonar],a.DepthCharges=[a.DepthCharge],a.Sonars=[a.Sonar,a.LargeSonar],a.AAGuns=[a.AAGun,a.AAGunConcentrated],a.AAFireDirectors=[a.AAFireDirector],a.AAFDs=a.AAFireDirectors,a.Searchlights=[a.Searchlight,a.SearchlightLarge],a.AviationPersonnels=[a.AviationPersonnel],a.SurfaceShipPersonnels=[a.SurfaceShipPersonnel],a.LandingCrafts=[a.LandingCraft,a.AmphibiousCraft],a.AmphibiousCrafts=[a.AmphibiousCraft],a.SupplyContainers=[a.SupplyContainer],a.CombatRations=[a.CombatRation],e.exports=a},function(e,t,r){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0),i=r(4),o=r(1),s=o.ArrayOrItem,u=o.ArrayOrItemAll;e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===(e=n(e)))return!1;for(var r in t)if(c[r.toLowerCase()]){if(!c[r.toLowerCase()](e,t[r]))return!1}else if("is"===r.substr(0,2)){var o=r.substr(2);if("HAMountAAFD"===o)o="HAMountsAAFD";else if(o+"s"in i)o+="s";else{if(!(o in i))return!1;o=o}var s="object"===a(t[r])&&!Array.isArray(t[r]),u=t[r]&&s?t[r]:void 0;if(!c[!0===t[r]||s?"istype":"isnottype"](e,i[o],u))return!1}return!0};var c={isid:function(e,t){return s(t,function(t){return!isNaN(t)&&parseInt(t)===e.id})},isnotid:function(e,t){return u(t,function(t){return!isNaN(t)&&parseInt(t)!==e.id})},isname:function(e,t){return s(t,function(t){return e.isName(t)})},isnotname:function(e,t){return u(t,function(t){return!e.isName(t)})},isnameof:function(e,t){return s(t,function(t){return e.hasName(t)})},isnotnameof:function(e,t){return u(t,function(t){return!e.hasName(t)})},istype:function(e,t,r){return s(t,function(t){if(isNaN(t))return!1;if(parseInt(t)!==e.type)return!1;if("object"===(void 0===r?"undefined":a(r))&&r.hasStat){var n=!0;for(var i in r.hasStat)Array.isArray(r.hasStat[i])?(e.stat[i]<r.hasStat[i][0]&&(n=!1),e.stat[i]>r.hasStat[i][1]&&(n=!1)):e.stat[i]<r.hasStat[i]&&(n=!1);if(!n)return!1}return!0})},isnottype:function(e,t){return u(t,function(t){return!isNaN(t)&&parseInt(t)!==e.type})},isaaradar:function(e,t){return(this.istype(e,i.Radars)&&!isNaN(e.stat.aa)&&e.stat.aa>=2)===t},issurfaceradar:function(e,t){return(this.istype(e,i.Radars)&&(isNaN(e.stat.aa)||e.stat.aa<2))===t}}},function(e,t,r){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(0);var i=r(5),o=["id","name","nameof","type"];e.exports=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Array.isArray(t))return e([t],r);var s=function(e){if(!1===r[e]){if(!t.every(function(t){return i(t,n({},e.replace(/^has/,"is"),r[e]))}))return{v:!1}}else if(!0===r[e]){if(!t.some(function(t){return i(t,n({},e.replace(/^has/,"is"),r[e]))}))return{v:!1}}else if("has"===e.substr(0,3)&&o.includes(e.substr(3).toLowerCase())){if(Array.isArray(r[e])){if(!r[e].every(function(r){return t.some(function(t){return i(t,n({},e.replace(/^has/,"is"),r))})}))return{v:!1}}else if(!t.some(function(t){return i(t,n({},e.replace(/^has/,"is"),r[e]))}))return{v:!1}}else if("has"!==e.substr(0,3)||"object"!==a(r[e])||Array.isArray(r[e])){if("has"!==e.substr(0,3)||isNaN(r[e])){if("has"===e.substr(0,3)&&Array.isArray(r[e])){var s=t.filter(function(t){return i(t,n({},e.replace(/^has/,"is"),!0))});if(s.length<r[e][0]||s.length>r[e][1])return{v:!1}}}else if(t.filter(function(t){return i(t,n({},e.replace(/^has/,"is"),!0))}).length<r[e])return{v:!1}}else{var u=Object.assign({},r[e]),c=void 0===u.count?1:u.count;if(delete u.count,t.filter(function(t){return i(t,n({},e.replace(/^has/,"is"),u))}).length<c)return{v:!1}}};for(var u in r){var c=s(u);if("object"===(void 0===c?"undefined":a(c)))return c.v}return!0}},function(e,t,r){"use strict";e.exports=function(e,t){return Array.isArray(e)?e.every(t):t(e)}},function(e,t,r){"use strict";e.exports=function(e,t){return Array.isArray(e)?e.some(t):t(e)}},function(e,t,r){"use strict";var a=r(2),n=r(1),i=n.ArrayOrItem,o=n.ArrayOrItemAll;e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===(e=a(e)))return!1;for(var r in t)if(!s[r.toLowerCase()](e,t[r]))return!1;return!0};var s={isid:function(e,t){return i(t,function(t){return!isNaN(t)&&parseInt(t)===e.id})},isnotid:function(e,t){return o(t,function(t){return!isNaN(t)&&parseInt(t)!==e.id})},isname:function(e,t){return i(t,function(t){return e.isName(t)})},isnotname:function(e,t){return o(t,function(t){return!e.isName(t)})},istype:function(e,t){return i(t,function(t){return!isNaN(t)&&parseInt(t)===e.type})},isnottype:function(e,t){return o(t,function(t){return!isNaN(t)&&parseInt(t)!==e.type})},isbattleship:function(e,t){return this.istype(e,[8,6,20,7,18])===t},isbb:function(e,t){return this.isbattleship(e,t)},iscarrier:function(e,t){return this.istype(e,[11,10,9,30,32])===t},iscv:function(e,t){return this.iscarrier(e,t)},issubmarine:function(e,t){return this.istype(e,[14,13])===t},isss:function(e,t){return this.issubmarine(e,t)},isclass:function(e,t){return i(t,function(t){return!isNaN(t)&&parseInt(t)===e.class})},isnotclass:function(e,t){return o(t,function(t){return!isNaN(t)&&parseInt(t)!==e.class})},hasslot:function(e,t){return!!Array.isArray(e.slot)&&(Array.isArray(t)?isNaN(t[0])&&!isNaN(t[1])?e.slot.length<=parseInt(t[1]):!isNaN(t[0])&&isNaN(t[1])?e.slot.length>=parseInt(t[0]):!isNaN(t[0])&&!isNaN(t[1])&&(e.slot.length>=parseInt(t[0])&&e.slot.length<=parseInt(t[1])):!isNaN(t)&&parseInt(t)===e.slot.length)},hasslotmin:function(e,t){return this.hasslot(e,[t,void 0])},hasslotmax:function(e,t){return this.hasslot(e,[void 0,t])},minlevel:function(e,t){return void 0===e.level||e.level>=t}}},function(e,t,r){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var n=r(2),i=r(0);e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return"number"!=typeof t&&"string"!=typeof t||(t=[t]),"number"!=typeof r&&"string"!=typeof r||(r=[r]),"number"!=typeof o&&"string"!=typeof o||(o=[o]),e=n(e),t=[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(Array(Math.max(5,e.slot.length+1)))).map(function(r,a){if(e&&!(e.slot.length<=a&&a<4))return i(t[a])||void 0}),{ship:e,equipments:t,equipmentStars:t.map(function(e,n){return"object"===a(t[n])?Math.min(10,parseInt(r[n])||0):void 0}),equipmentRanks:t.map(function(e,r){return"object"===a(t[r])?Math.min(7,parseInt(o[r])||0):void 0})}}},function(e,t,r){"use strict";var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(10),o=r(9),s=r(6),u=r(3);e.exports=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],p=arguments[4];if("string"==typeof c)return e(t,r,void 0,void 0,c);if("string"==typeof l)return e(t,r,c,void 0,l);var h=i(t,r,c,l);t=h.ship,r=h.equipments,c=h.equipmentStars,l=h.equipmentRanks;var f={},d=u.filter(function(e){return o(t,e.ship)}),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t in e)void 0===f[t]?f[t]=e[t]:f[t]+=e[t]};return d.filter(function(e){return"number"==typeof e.equipment&&r.some(function(t){return t&&t.id&&t.id==e.equipment})}).forEach(function(e){var t={};if("object"===n(e.bonusImprove)){var i=Object.keys(e.bonusImprove).sort(function(e,t){return parseInt(t)-parseInt(e)});r.forEach(function(r,a){r&&r.id&&r.id==e.equipment&&i.some(function(r){if(c[a]>=r){for(var n in e.bonusImprove[r])void 0===t[n]?t[n]=e.bonusImprove[r][n]:t[n]+=e.bonusImprove[r][n];return!0}return!1})})}else{var o=0;if(r.forEach(function(t){t&&t.id&&t.id==e.equipment&&o++}),"object"===n(e.bonusCount))Object.keys(e.bonusCount).sort(function(e,t){return parseInt(t)-parseInt(e)}).some(function(r){return o>=r&&(t=a({},e.bonusCount[r]),!0)});else if("object"===n(e.bonus))for(var s in t=a({},e.bonus))t[s]=t[s]*o}m(t)}),d.filter(function(e){return"object"===n(e.equipments)&&s(r,e.equipments)}).forEach(function(e){m(e.bonus)}),"string"==typeof p?f[p]||0:f}},function(e,t,r){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}();function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}window.KC=function(){var e=r(11),t={lang:"zh_cn",joint:"・",maxShipLv:165,maxHqLv:120,db:{},path:{db:"/kcdb/",pics:{ships:"/kcpic/ships/"}},statSpeed:{5:"低速",10:"高速",15:"高速+",20:"最速"},getStatSpeed:function(e){return this.statSpeed[parseInt(e)]},statRange:{1:"短",2:"中",3:"长",4:"超长"},getStatRange:function(e){return this.statRange[parseInt(e)]},textRank:{1:"|",2:"||",3:"|||",4:"\\",5:"\\\\",6:"\\\\\\",7:"》"}},u=function(){function e(t){for(var r in s(this,e),t)this[r]=t[r]}return n(e,[{key:"getName",value:function(e){return e=e||t.lang,this.name?this.name[e]||this.name:null}},{key:"isName",value:function(e,r){if(!0===r&&(r=t.lang),r)return this.name[r]===e;for(var a in this.name)if("suffix"!==a&&this.name[a]===e)return!0;return!1}},{key:"hasName",value:function(e,r){if(!0===r&&(r=t.lang),r)return!!this.name[r].includes(e);for(var a in this.name)if("suffix"!==a&&this.name[a].includes(e))return!0;return!1}},{key:"isNameOf",value:function(){return this.hasName.apply(this,arguments)}},{key:"_name",get:function(){return this.getName()}}]),e}(),c=function(e){function t(e){return s(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),t}(u),l=function(e){function r(e){s(this,r);var t=i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return Object.defineProperty(t,"rankupgradable",{value:t.isRankUpgradable()}),t}return o(r,e),n(r,[{key:"getName",value:function(e,r){r=r||t.lang;var a=u.prototype.getName.call(this,r),n=e&&1==!e?e:"small";return e?a.replace(/（([^（^）]+)）/g,"<"+n+">($1)</"+n+">"):a}},{key:"getType",value:function(e){return e=e||t.lang,this.type?t.db.item_types[this.type].name[e]:null}},{key:"getIconId",value:function(){return Array.isArray(this.type_ingame)&&this.type_ingame.length>3?this.type_ingame[3]:t.db.item_types[this.type].icon}},{key:"getCaliber",value:function(){var e=this.getName(!1,"ja_jp"),t=parseFloat(e);return t}},{key:"getPower",value:function(){return this.stat[t.db.item_types[this.type].main_attribute||"fire"]}},{key:"isEquipableExSlot",value:function(){return this.equipable_exslot?this.equipable_exslot||!1:this.type&&t.db.item_types[this.type].equipable_exslot||!1}},{key:"isRankUpgradable",value:function(){return g.equipmentType.Aircrafts.includes(this.type)&&this.type!==g.equipmentType.Autogyro&&this.type!==g.equipmentType.AntiSubPatrol}},{key:"getStat",value:function(e,r){e=e.toLowerCase();var n=this.stat[e];if(!r||void 0===n||!Array.isArray(this.stat_bonus))return n;if(r&&Array.isArray(this.stat_bonus)){"object"!==(void 0===r?"undefined":a(r))&&(r=t.db.ships[r]);var i=r.id,o=void 0;if(this.stat_bonus.forEach(function(e){Array.isArray(e.ships)&&e.ships.some(function(t){if(t==i){for(var r in e.bonus)o||(o={}),o[r]=Math.max(e.bonus[r],o[r]||0);return!0}return!1}),Array.isArray(e.ship_classes)&&e.ship_classes.some(function(t){if(t==r.class){for(var a in e.bonus)o||(o={}),o[a]=Math.max(e.bonus[a],o[a]||0);return!0}return!1})}),o)return n+(o[e]||0)}return n}},{key:"_icon",get:function(){return"assets/images/itemicon/"+this.getIconId()+".png"}}]),r}(u),p=function(e){function r(e){return s(this,r),i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))}return o(r,e),n(r,[{key:"getName",value:function(e,r){e=e||"",r=r||t.lang;var a=this.getSuffix(r);return(this.name[r]||this.name.ja_jp)+(a?(!0===e?t.joint:e)+a:"")}},{key:"getNameNoSuffix",value:function(e){return e=e||t.lang,this.name[e]||this.name.ja_jp}},{key:"getSuffix",value:function(e){return e=e||t.lang,this.name.suffix&&(t.db.ship_namesuffix[this.name.suffix][e]||t.db.ship_namesuffix[this.name.suffix].ja_jp)||""}},{key:"getType",value:function(e){return e=e||t.lang,this.type?t.db.ship_types[this.type].name[e]||t.db.ship_types[this.type].name.ja_jp||"":null}},{key:"getSeriesData",value:function(){return this.series?t.db.ship_series[this.series].ships:[{id:this.id}]}},{key:"getPic",value:function(e,r){var a=this.getSeriesData();e=parseInt(e||0);for(var n=function(e,a){return"undefined"!=typeof node&&node&&node.path&&t.path.pics.ships?node.path.join(t.path.pics.ships,e+"/"+a+"."+(r||"webp")):t.path.pics.ships?t.path.pics.ships+e+"/"+a+"."+(r||"png"):"/"+e+"/"+a+"."+(r||"png")},i=0;i<a.length;i++)if(a[i].id==this.id)switch(e){case 0:case 1:case 2:case 3:case 12:case 13:case 14:return n(this.id,e);default:return a[i].illust_delete?n(a[i-1].id,e):n(this.id,e)}}},{key:"getSpeed",value:function(){return t.statSpeed[parseInt(this.stat.speed)]}},{key:"getSpeedRule",value:function(){return this.speed_rule?this.speed_rule:this.class?t.db.ship_classes[this.class].speed_rule:null}},{key:"getRange",value:function(){return t.statRange[parseInt(this.stat.range)]}},{key:"getEquipmentTypes",value:function(){var e=this.additional_disable_item_types||[];return t.db.ship_types[this.type].equipable.concat(this.additional_item_types||[]).filter(function(t){return e.indexOf(t)<0}).sort(function(e,t){return e-t})}},{key:"getAttribute",value:function(e,a){(a=a||1)>r.lvlMax&&(a=r.lvlMax);var n=void 0;switch(e){case"hp":return n=this.stat.hp,a>99&&(n=this.stat.hp>=90?this.stat.hp+9:this.stat.hp>=70?this.stat.hp+8:this.stat.hp>=50?this.stat.hp+7:this.stat.hp>=40?this.stat.hp+6:this.stat.hp>=30?this.stat.hp+5:this.stat.hp+4)>this.stat.hp_max&&(n=this.stat.hp_max),n;case"speed":return t.getStatSpeed(this.stat.speed);case"range":return t.getStatRange(this.stat.range);case"luck":return a>99?this.stat.luck+3:this.stat.luck;case"fuel":case"ammo":return a>99?Math.floor(.85*this.consum[e]):this.consum[e];case"aa":case"armor":case"fire":case"torpedo":return this.stat[e+"_max"]||this.stat[e];default:return function(e,t,r){return e=e||1,t=parseFloat(t),r=parseFloat(r)||t,t<0||r<0?-1:t==r?r:Math.floor(t+(r-t)*e/99)}(a,this.stat[e],this.stat[e+"_max"])}}},{key:"getRel",value:function(e){if(e){if(!this.rels[e]&&this.remodel&&this.remodel.prev)for(var r=t.db.ships[this.remodel.prev];r;){if(r.rels&&r.rels[e])return r.rels[e];r=r.remodel&&r.remodel.prev?t.db.ships[r.remodel.prev]:null}return this.rels[e]}return this.rels}},{key:"getCV",value:function(e){var r=this.getRel("cv");if(r)return t.db.entities[r].getName(e||t.lang)}},{key:"getIllustrator",value:function(e){var r=this.getRel("illustrator");if(r)return t.db.entities[r].getName(e||t.lang)}},{key:"getMinLv",value:function(){var e=this,t=this._series,r=void 0;return t.some(function(a,n){return e.id==a.id&&(r=n?t[n-1].next_lvl:1),r}),r}},{key:"getNavy",value:function(){return this.navy?this.navy:this.class&&t.db.ship_classes[this.class].navy||"ijn"}},{key:"getCapability",value:function(e){return e?this.capabilities?this.capabilities[e]:void 0:this.capabilities||{}}},{key:"getStatExtraMax",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(e.toLowerCase()){case"hp":var r=this.getAttribute(e,t),a=this.stat.hp_max;return Math.max(0,Math.min(2,a-r));case"asw":return this.stat.asw?9:!!g.shipType.LightCruisers.concat(g.shipType.Destroyers).includes(this.type)&&9;default:return!1}}},{key:"_type",get:function(){return this.getType()}},{key:"_series",get:function(){return this.getSeriesData()}},{key:"_pics",get:function(){for(var e=[],t=0;t<15;t++)e.push(this.getPic(t));return e}},{key:"_speed",get:function(){return this.getSpeed()}},{key:"_speedRule",get:function(){return this.getSpeedRule()}},{key:"_range",get:function(){return this.getRange()}},{key:"_cv",get:function(){return this.getCV()}},{key:"_illustrator",get:function(){return this.getIllustrator()}},{key:"_minLv",get:function(){return this.getMinLv()}},{key:"_navy",get:function(){return this.getNavy()}}]),r}(u);p.lvlMax=t.maxShipLv;var h=function(e){function t(e){return s(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),t}(u);t.dbLoad=function(e){return"string"==typeof e?t.dbLoad({type:e}):e.type||e.url?$.ajax({url:e.url||t.path.db+"/"+e.type+".json",dataType:"text",success:function(r){var a=[];e.beforeProcess&&(a=e.beforeProcess(r)),void 0===t.db[e.type]&&(t.db[e.type]={}),a.forEach(function(r){if(r){var a=JSON.parse(r);switch(e.type){case"ships":t.db[e.type][a.id]=new p(a);break;case"items":t.db[e.type][a.id]=new l(a);break;case"entities":t.db[e.type][a.id]=new c(a);break;default:t.db[e.type][a.id]=a}}}),e.success&&e.success(r)},complete:function(t,r){e.complete&&e.complete(t,r)}}):null};var f=function(e){return e instanceof p?e:t.db.ships?t.db.ships[e]:{}},d=function(e){return e instanceof l?e:t.db.equipments?t.db.equipments[e]:t.db.items[e]},m=function(e){var t=[];return e.forEach(function(e,r){t[r>=4?r+1:r]=e}),t[4]=0,t},g={equipmentType:{SmallCaliber:1,SmallCaliberHigh:2,SmallCaliberAA:3,MediumCaliber:4,LargeCaliber:5,SuperCaliber:6,SecondaryGun:7,SecondaryGunHigh:8,SecondaryGunAA:9,APShell:11,Torpedo:12,SubmarineTorpedo:13,MidgetSubmarine:14,ReconSeaplane:15,ReconSeaplaneNight:16,SeaplaneBomber:17,CarrierFighter:18,TorpedoBomber:19,DiveBomber:20,CarrierRecon:21,Autogyro:22,AntiSubPatrol:23,SmallRadar:24,LargeRadar:25,DepthCharge:26,Sonar:27,LargeSonar:28,AAGun:29,AAGunConcentrated:30,AAFireDirector:31,AviationPersonnel:36,SurfaceShipPersonnel:37,LandingCraft:38,Searchlight:39,CommandFacility:45,LargeFlyingBoat:45,SearchlightLarge:46,SuparRadar:47,CarrierRecon2:50,SeaplaneFighter:51,AmphibiousCraft:52,LandBasedAttacker:53,Interceptor:54,JetBomberFighter:55,JetBomberFighter2:56,TransportMaterial:57,SubmarineEquipment:58,LandBasedFighter:59,CarrierFighterNight:60,TorpedoBomberNight:61,LandBasedAntiSubPatrol:62},shipType:{Carriers:[9,10,11,30,32],LightCruisers:[2,3,21,28],Destroyers:[1,19],Submarines:[13,14]},calcByShip:{},calcByFleet:{},calcByField:{},calc:{}},b=g.equipmentType;return b.MainGuns=[b.SmallCaliber,b.SmallCaliberHigh,b.SmallCaliberAA,b.MediumCaliber,b.LargeCaliber,b.SuperCaliber],b.SmallCalibers=[b.SmallCaliber,b.SmallCaliberHigh,b.SmallCaliberAA],b.MediumCalibers=[b.MediumCaliber],b.LargeCalibers=[b.LargeCaliber,b.SuperCaliber],b.SecondaryGuns=[b.SecondaryGun,b.SecondaryGunHigh,b.SecondaryGunAA],b.APShells=[b.APShell],b.Torpedos=[b.Torpedo,b.SubmarineTorpedo],b.Seaplanes=[b.ReconSeaplane,b.ReconSeaplaneNight,b.SeaplaneBomber,b.SeaplaneFighter],b.Fighters=[b.SeaplaneBomber,b.CarrierFighter,b.CarrierFighterNight,b.TorpedoBomber,b.TorpedoBomberNight,b.DiveBomber,b.SeaplaneFighter,b.LandBasedAttacker,b.Interceptor,b.JetBomberFighter,b.JetBomberFighter2,b.LandBasedFighter],b.Interceptors=[b.Interceptor,b.LandBasedFighter],b.Recons=[b.ReconSeaplane,b.ReconSeaplaneNight,b.CarrierRecon,b.CarrierRecon2,b.LargeFlyingBoat],b.ReconSeaplanes=[b.ReconSeaplane,b.ReconSeaplaneNight],b.SeaplaneRecons=[b.ReconSeaplane,b.ReconSeaplaneNight,b.LargeFlyingBoat],b.SeaplaneBombers=[b.SeaplaneBomber,b.SeaplaneFighter],b.SeaplaneFighters=[b.SeaplaneFighter],b.CarrierFighters=[b.CarrierFighter,b.CarrierFighterNight],b.CarrierRecons=[b.CarrierRecon,b.CarrierRecon2],b.CarrierBased=[b.CarrierFighter,b.CarrierFighterNight,b.TorpedoBomber,b.TorpedoBomberNight,b.DiveBomber,b.CarrierRecon,b.CarrierRecon2,b.JetBomberFighter,b.JetBomberFighter2],b.LandBased=[b.LandBasedAttacker,b.Interceptor,b.JetBomberFighter,b.JetBomberFighter2,b.LandBasedFighter,b.LandBasedAntiSubPatrol],b.TorpedoBombers=[b.TorpedoBomber,b.TorpedoBomberNight],b.DiveBombers=[b.DiveBomber],b.JetBomberFighters=[b.JetBomberFighter,b.JetBomberFighter2],b.Autogyros=[b.Autogyro],b.AntiSubPatrols=[b.AntiSubPatrol,b.LandBasedAntiSubPatrol],b.Aircrafts=[],[].concat(b.Seaplanes).concat(b.Recons).concat(b.CarrierBased).concat(b.Autogyros).concat(b.AntiSubPatrols).concat(b.LandBased).forEach(function(e){b.Aircrafts.indexOf(e)<0&&b.Aircrafts.push(e)}),b.Radars=[b.SmallRadar,b.LargeRadar,b.SuparRadar],b.SmallRadars=[b.SmallRadar],b.LargeRadars=[b.LargeRadar,b.SuparRadar],b.AntiSubmarines=[b.DepthCharge,b.Sonar,b.LargeSonar],b.DepthCharges=[b.DepthCharge],b.Sonars=[b.Sonar,b.LargeSonar],b.AAGuns=[b.AAGun,b.AAGunConcentrated],b.AAFireDirectors=[b.AAFireDirector],b.Searchlights=[b.Searchlight,b.SearchlightLarge],b.AviationPersonnels=[b.AviationPersonnel],b.SurfaceShipPersonnels=[b.SurfaceShipPersonnel],b.LandingCrafts=[b.LandingCraft,b.AmphibiousCraft],b.AmphibiousCrafts=[b.AmphibiousCraft],b.isInterceptor=function(e){return(!(e=d(e)).type_ingame||47!=e.type_ingame[2])&&b.Interceptors.indexOf(e.type)>-1},g.starMultiper={SmallCalibers:{shelling:1,night:1},MediumCalibers:{shelling:1,night:1},LargeCalibers:{shelling:1.5,night:1},SecondaryGuns:{shelling:1,night:1,hit:1},APShells:{shelling:1,night:1},AAFireDirectors:{shelling:1,night:1},Searchlights:{shelling:1,night:1},AAGuns:{shelling:1,torpedo:1.2},Torpedos:{torpedo:1.2,night:1},DepthCharges:{shelling:.75,antisub:1},Sonars:{shelling:.75,antisub:1},SmallRadars:{los:1.25},LargeRadars:{los:1.4},Seaplanes:{},ReconSeaplanes:{los:1.2},SeaplaneFighters:{fighter:.2},SeaplaneBomber:{los:1.15},CarrierFighters:{fighter:.2},DiveBombers:{fighter:.25,night:1},CarrierRecons:{los:1.2},LandingCrafts:{shelling:1,night:1},Interceptors:{fighter:.2},_10:{shelling:["multiplication",.2],night:1},_66:{shelling:["multiplication",.2],night:1},_220:{shelling:["multiplication",.2],night:1},_275:{shelling:["multiplication",.2],night:1},_12:{shelling:["multiplication",.3],night:["multiplication",.3]},_234:{shelling:["multiplication",.3],night:["multiplication",.3]}},g.getStarMultiplier=function(e,t){if(!g.starMultiper._init){var r=function(e){b[e]&&b[e].forEach?b[e].forEach(function(t){g.starMultiper[t]=g.starMultiper[e]}):"number"==typeof b[e]&&(g.starMultiper[b[e]]=g.starMultiper[e])};for(var a in g.starMultiper)r(a);g.starMultiper._init=!0}var n=g.starMultiper[e]||{};return t?n[t]||0:n},g.getStarBonus=function(e,t,r){e=d(e);var a=Object.assign({},g.getStarMultiplier(e.type),g.starMultiper["_"+e.id])[t],n=void 0===a?0:a,i="sqrt";switch(Array.isArray(n)&&(i=n[0],n=n[1]),i){case"sqrt":return n*Math.sqrt(r);case"multiplication":case"multiple":return n*r}},g.getFighterPowerRankMultiper=function(e,t){e=d(e);var r=[],a={};r[0]=[0,9],r[1]=[10,24],r[2]=[25,39],r[3]=[40,54],r[4]=[55,69],r[5]=[70,84],r[6]=[85,99],r[7]=[100,120],a.CarrierFighter=[0,0,2,5,9,14,14,22],a.SeaplaneBomber=[0,0,1,1,1,3,3,6];var n=r[t],i=0;switch(e.type){case b.CarrierFighter:case b.CarrierFighterNight:case b.Interceptor:case b.SeaplaneFighter:case b.LandBasedFighter:i=a.CarrierFighter[t];break;case b.SeaplaneBomber:i=a.SeaplaneBomber[t]}return{min:Math.sqrt(n[0]/10)+i,max:Math.sqrt(n[1]/10)+i}},g.calculate=function(r,a,n,i,o,s){if(!r||!a)return 0;a instanceof p||(a=t.db.ships[a]);var u=0,c={main:0,secondary:0,torpedo:0,torpedoLateModel:0,seaplane:0,apshell:0,radar:0,radarAA:0,radarSurface:0,submarineEquipment:0,carrierFighterNight:0,torpedoBomberNight:0,aviationPersonnelNight:0,surfaceShipPersonnel:0},h=m(a.slot),f=0;n=n.map(function(e){return e?e instanceof l?e:t.db.equipments?t.db.equipments[e]:t.db.items[e]:null})||[],i=i||[],o=o||[],s=s||{},n.forEach(function(e){e&&(b.MainGuns.indexOf(e.type)>-1?c.main+=1:b.SecondaryGuns.indexOf(e.type)>-1?c.secondary+=1:b.Torpedos.indexOf(e.type)>-1?(c.torpedo+=1,e.name.ja_jp.indexOf("後期型")>-1&&(c.torpedoLateModel+=1)):b.Seaplanes.indexOf(e.type)>-1?c.seaplane+=1:b.APShells.indexOf(e.type)>-1?c.apshell+=1:b.Radars.indexOf(e.type)>-1?(c.radar+=1,e.stat.aa&&(c.radarAA+=1),e.stat.hit&&e.stat.hit>=3&&(c.radarSurface+=1)):b.SubmarineEquipment==e.type?c.submarineEquipment+=1:b.AviationPersonnels.indexOf(e.type)>-1?e.name.ja_jp.indexOf("夜間")>-1&&(c.aviationPersonnelNight+=1):b.SurfaceShipPersonnels.indexOf(e.type)>-1&&(c.surfaceShipPersonnel+=1),e.type_ingame&&(45===e.type_ingame[3]?c.carrierFighterNight+=1:46===e.type_ingame[3]&&(c.torpedoBomberNight+=1)))});var d=e(a,n,i,o);switch(r){case"fighterPower":return f=0,h.map(function(e,t){if(n[t]&&b.Fighters.indexOf(n[t].type)>-1&&e){if(f=Math.sqrt(e)*(n[t].getStat("aa",a)||0),b.CarrierFighters.includes(n[t].type))switch(o[t]){case 1:case"1":f+=1;break;case 2:case"2":f+=4;break;case 3:case"3":f+=6;break;case 4:case"4":f+=11;break;case 5:case"5":f+=16;break;case 6:case"6":f+=17;break;case 7:case"7":f+=25}else if(-1==b.Recons.indexOf(n[t].type)){var r=n[t].type==b.SeaplaneBomber?9:3;f+=1==o[t]?1:r/6*(o[t]-1)}u+=Math.floor(f)}}),u;case"fighterPower_v2":return g.calcByShip.fighterPower_v2(a,n,i,o);case"shelling":case"shellingDamage":return g.shipType.Submarines.indexOf(a.type)>-1?"-":(u=g.calcByShip.shellingPower(a,n,i,o,{},d))&&u>-1?Math.floor(u):"-";case"torpedo":case"torpedoDamage":return(u=function(e){return g.calcByShip.torpedoPower(a,n,i,o,e,d)}())&&u>-1?Math.floor(u):"-";case"nightBattle":var y=g.calcByShip.nightPower(a,n,i,o,{},c,d);return y.damage<=0?"-":y.value;case"addHit":return h.map(function(e,t){n[t]&&(u+=n[t].getStat("hit",a)||0)}),(u+=d.hit||0)>=0?"+"+u:u;case"addArmor":return h.map(function(e,t){n[t]&&(u+=n[t].getStat("armor",a)||0)}),u+(d.armor||0);case"addEvasion":return h.map(function(e,t){n[t]&&(u+=n[t].getStat("evasion",a)||0)}),u+(d.evasion||0);case"losPower":return g.calcByShip.losPower(a,n,i,o,s);default:return g.calcByShip[r](a,n,i,o,s,d)}},g.shellingDamage=function(e,t,r,a){return this.calculate("shellingDamage",e,t,r,a)},g.torpedoDamage=function(e,t,r,a){return this.calculate("torpedoDamage",e,t,r,a)},g.fighterPower=function(e,t,r,a){return this.calculate("fighterPower",e,t,r,a)},g.fighterPower_v2=function(e,t,r,a){return this.calculate("fighterPower_v2",e,t,r,a)},g.nightBattle=function(e,t,r,a){return this.calculate("nightBattle",e,t,r,a)},g.addHit=function(e,t,r,a){return this.calculate("addHit",e,t,r,a)},g.addArmor=function(e,t,r,a){return this.calculate("addArmor",e,t,r,a)},g.addEvasion=function(e,t,r,a){return this.calculate("addEvasion",e,t,r,a)},g.losPower=function(e,t,r,a,n){return this.calculate("losPower",e,t,r,a,n)},g.calc.losPower=function(e){var t=["(Intercept)","DiveBombers","TorpedoBombers","CarrierRecons","SeaplaneRecons","SeaplaneBombers","SmallRadars","LargeRadars","Searchlights","statLos","hqLv"],r={"(Intercept)":0,DiveBombers:1.03745043134563,TorpedoBombers:1.3679056374142,CarrierRecons:1.65940512636315,SeaplaneRecons:2,SeaplaneBombers:1.77886368594467,SmallRadars:1.0045778494921,LargeRadars:.990738063979571,Searchlights:.906965144360512,statLos:1.6841895400986,hqLv:-.614246711531445},a={"(Intercept)":4.66445565766347,DiveBombers:.0965028505325845,TorpedoBombers:.108636184978525,CarrierRecons:.0976055279516298,SeaplaneRecons:.0866229392463539,SeaplaneBombers:.0917722496848294,SmallRadars:.0492773648320346,LargeRadars:.0491221486053861,Searchlights:.0658283797225724,statLos:.0781594211213618,hqLv:.0369222352426548},n={"(Intercept)":{"(Intercept)":1,DiveBombers:-.147020064768061,TorpedoBombers:-.379236131621529,CarrierRecons:-.572858669501918,SeaplaneRecons:-.733913857017495,SeaplaneBombers:-.642621825152428,SmallRadars:-.674829588068364,LargeRadars:-.707418111752863,Searchlights:-.502304601556193,statLos:-.737374218573832,hqLv:-.05071933950163},DiveBombers:{"(Intercept)":-.147020064768061,DiveBombers:1,TorpedoBombers:.288506347076736,CarrierRecons:.365820372770994,SeaplaneRecons:.425744409856409,SeaplaneBombers:.417783698791503,SmallRadars:.409046013184429,LargeRadars:.413855653833994,Searchlights:.308730607324667,statLos:.317984916914851,hqLv:-.386740224500626},TorpedoBombers:{"(Intercept)":-.379236131621529,DiveBombers:.288506347076736,TorpedoBombers:1,CarrierRecons:.482215071254241,SeaplaneRecons:.584455876852325,SeaplaneBombers:.558515133495825,SmallRadars:.547260012897553,LargeRadars:.560437619378443,Searchlights:.437934879351188,statLos:.533934507932748,hqLv:-.405349979885748},CarrierRecons:{"(Intercept)":-.572858669501918,DiveBombers:.365820372770994,TorpedoBombers:.482215071254241,CarrierRecons:1,SeaplaneRecons:.804494553748065,SeaplaneBombers:.75671307047535,SmallRadars:.748420581669228,LargeRadars:.767980338133817,Searchlights:.589651513349878,statLos:.743851348255527,hqLv:-.503544281376776},SeaplaneRecons:{"(Intercept)":-.733913857017495,DiveBombers:.425744409856409,TorpedoBombers:.584455876852325,CarrierRecons:.804494553748065,SeaplaneRecons:1,SeaplaneBombers:.932444440578382,SmallRadars:.923988080549326,LargeRadars:.94904944359066,Searchlights:.727912987329348,statLos:.944434077970518,hqLv:-.614921413821462},SeaplaneBombers:{"(Intercept)":-.642621825152428,DiveBombers:.417783698791503,TorpedoBombers:.558515133495825,CarrierRecons:.75671307047535,SeaplaneRecons:.932444440578382,SeaplaneBombers:1,SmallRadars:.864289865445084,LargeRadars:.886872388674911,Searchlights:.68310647756898,statLos:.88122333327317,hqLv:-.624797255805045},SmallRadars:{"(Intercept)":-.674829588068364,DiveBombers:.409046013184429,TorpedoBombers:.547260012897553,CarrierRecons:.748420581669228,SeaplaneRecons:.923988080549326,SeaplaneBombers:.864289865445084,SmallRadars:1,LargeRadars:.872011318623459,Searchlights:.671926570242336,statLos:.857213501657084,hqLv:-.560018086758868},LargeRadars:{"(Intercept)":-.707418111752863,DiveBombers:.413855653833994,TorpedoBombers:.560437619378443,CarrierRecons:.767980338133817,SeaplaneRecons:.94904944359066,SeaplaneBombers:.886872388674911,SmallRadars:.872011318623459,LargeRadars:1,Searchlights:.690102027588321,statLos:.883771367337743,hqLv:-.561336967269448},Searchlights:{"(Intercept)":-.502304601556193,DiveBombers:.308730607324667,TorpedoBombers:.437934879351188,CarrierRecons:.589651513349878,SeaplaneRecons:.727912987329348,SeaplaneBombers:.68310647756898,SmallRadars:.671926570242336,LargeRadars:.690102027588321,Searchlights:1,statLos:.723228553177704,hqLv:-.518427865593732},statLos:{"(Intercept)":-.737374218573832,DiveBombers:.317984916914851,TorpedoBombers:.533934507932748,CarrierRecons:.743851348255527,SeaplaneRecons:.944434077970518,SeaplaneBombers:.88122333327317,SmallRadars:.857213501657084,LargeRadars:.883771367337743,Searchlights:.723228553177704,statLos:1,hqLv:-.620804120587684},hqLv:{"(Intercept)":-.05071933950163,DiveBombers:-.386740224500626,TorpedoBombers:-.405349979885748,CarrierRecons:-.503544281376776,SeaplaneRecons:-.614921413821462,SeaplaneBombers:-.624797255805045,SmallRadars:-.560018086758868,LargeRadars:-.561336967269448,Searchlights:-.518427865593732,statLos:-.620804120587684,hqLv:1}},i={DiveBombers:0,TorpedoBombers:0,CarrierRecons:0,SeaplaneRecons:0,SeaplaneBombers:0,SmallRadars:0,LargeRadars:0,Searchlights:0,statLos:1,hqLv:1};for(var o in e)i[o]=e[o];return function(e){void 0===e["(Intercept)"]&&(e["(Intercept)"]=1),e.hqLv=5*Math.ceil(e.hqLv/5);var i={},o=0,s={},u=0;return t.forEach(function(t){var n=e[t]*r[t];i[t]=n,o+=n,s[t]=e[t]*a[t]}),t.forEach(function(e){t.forEach(function(t){u+=s[e]*s[t]*n[e][t]})}),{x_estimate:i,y_estimate:o,x_std_error:s,y_std_error:u}}(i)},g.calc.los33=function(e){if(e){var t=0,r=0,a={TorpedoBombers:.8,CarrierRecons:1,ReconSeaplane:1.2,ReconSeaplaneNight:1.2,SeaplaneBomber:1.1};return Object.defineProperty(a,"default",{value:.6,enumerable:!1,configurable:!1,writable:!1}),e.equipments.forEach(function(e){if(e.id){var r=d(e.id);if(r.stat.los){var n=a.default,i=e.star||0;for(var o in a)(Array.isArray(b[o])?b[o]:[b[o]]).indexOf(r.type)>-1&&(n=a[o]);t+=n*(r.stat.los+g.getStarBonus(r,"los",i))}}}),e.ships.forEach(function(e){var t=f(e.id),a=t.getAttribute("los",Math.max(e.lv||1,t.getMinLv()));r+=Math.sqrt(Math.max(a,1))}),t+r-Math.ceil(.4*e.hq)+2*(6-e.ships.length)}},g.calc.TP=function(e){var t=0,r=(e=e||{}).ship||{},a=e.equipment||{};for(var n in r){var i=0;switch(n){case 1:case"1":case 19:case"19":case"dd":i=5;break;case 2:case"2":case 28:case"28":case"cl":i=2;break;case 21:case"21":case"ct":i=6;break;case 5:case"5":case"cav":i=4;break;case 8:case"8":case"bbv":i=7;break;case 12:case"12":case 24:case"24":case"av":i=9.5;break;case 14:case"14":case"ssv":i=1;break;case 15:case"15":case"lha":i=12;break;case 29:case"29":case"ao":i=15;break;case 17:case"17":case"as":i=7}t+=i*(parseInt(r[n])||0)}for(var o in a){var s=0,u=parseInt(o),c=void 0;switch(u){case 145:case 150:s=1;break;case 75:s=5;break;case 68:case 193:case 166:s=8;break;case 167:s=2;break;default:switch((c=d(u)).type){case g.equipmentType.LandingCraft:c.name.ja_jp.indexOf("大発動艇")>-1&&(s=8)}}t+=s*(parseInt(a[o])||0)}return t},g.calc.fighterPower=function(e,r,a,n){if(!e)return[0,0];e=e instanceof l?e:t.db.equipments?t.db.equipments[e]:t.db.items[e],r=r||0,a=a||0,n=n||0;var i=[0,0];if(b.Fighters.indexOf(e.type)>-1&&r){var o=((e.stat.aa||0)+(b.isInterceptor(e)?1.5*e.stat.evasion:0)+n*g.getStarMultiplier(e.type,"fighter"))*Math.sqrt(r),s=g.getFighterPowerRankMultiper(e,a);i[0]+=Math.floor(o+s.min),i[1]+=Math.floor(o+s.max)}return i},g.calc.fighterPowerAA=function(e,t,r,a){if(!e)return[0,0];e=d(e),t=t||0,r=r||0,a=a||0;var n=[0,0];if(t){var i=((e.stat.aa||0)+(b.isInterceptor(e)?e.stat.evasion:0)+(b.isInterceptor(e)?2*e.stat.hit:0)+a*g.getStarMultiplier(e.type,"fighter"))*Math.sqrt(t),o=g.getFighterPowerRankMultiper(e,r,{isAA:!0});n[0]+=Math.floor(i+o.min),n[1]+=Math.floor(i+o.max)}return n},g.calcByShip.shellingPower=function(t,r,a,n,i,o){i=i||{},o=o||e(t,r,a,n);var s=0,u=!1,c=m(t.slot);if(g.shipType.Carriers.indexOf(t.type)>-1?u=!0:r.some(function(e){if(e&&!u&&b.CarrierBased.indexOf(e.type)>-1)return u=!0,!0}),u&&!i.isNight){var l=0,p=0;return c.map(function(e,n){if(r[n]){var i=r[n];s+=1.5*i.getStat("fire",t)||0,b.TorpedoBombers.indexOf(i.type)>-1&&(l+=i.getStat("torpedo",t)||0),p+=i.getStat("bomb",t)||0,b.SecondaryGuns.indexOf(i.type)>-1&&(s+=Math.sqrt(1.5*(a[n]||0)))}}),l||p?s+=Math.floor(1.5*(Math.floor(1.3*p)+l+t.stat.fire_max+(o.fire||0)))+50:-1}s=t.stat.fire_max||0;var h={CLMainGunNaval:0,CLMainGunTwin:0,ItalianCAMainGun:0};c.map(function(e,n){if(r[n]){var o=r[n];s+=o.getStat("fire",t)||0,g.shipType.LightCruisers.indexOf(t.type)>-1&&(["14cm単装砲","15.2cm単装砲"].forEach(function(e){o.name.ja_jp.includes(e)&&(h.CLMainGunNaval+=1)}),["14cm連装砲","15.2cm連装砲"].forEach(function(e){o.name.ja_jp.includes(e)&&(h.CLMainGunTwin+=1)})),"rm"===t._navy&&o.name.ja_jp.includes("203mm/53")&&(h.ItalianCAMainGun+=1),a[n]&&!i.isNight&&(s+=g.getStarBonus(o,"shelling",a[n]))}});var f=0+2*Math.sqrt(h.CLMainGunTwin)+Math.sqrt(h.CLMainGunNaval)+Math.sqrt(h.ItalianCAMainGun)+(o.fire||0);return s+f},g.calcByShip.torpedoPower=function(t,r,a,n,i,o){i=i||{},o=o||e(t,r,a,n);var s=0,u=m(t.slot);return g.shipType.Carriers.indexOf(t.type)>-1&&!i.isNight?i.returnZero?0:-1:(s=(t.stat.torpedo_max||0)+(o.torpedo||0),u.map(function(e,n){if(r[n]){var o=r[n];s+=b.TorpedoBombers.indexOf(o.type)>-1&&!i.isNight?0:o.getStat("torpedo",t)||0,a[n]&&!i.isNight&&(s+=g.getStarBonus(o,"torpedo",a[n]))}}),s)},g.calcByShip.nightPower=function(t,r,a,n,i,o,s){i=i||{},s=s||e(t,r,a,n);var u={damage:0},c=0,l=m(t.slot);if((o.aviationPersonnelNight||t.getCapability("count_as_night_operation_aviation_personnel"))&&(o.carrierFighterNight>=1||o.torpedoBomberNight>=1)){l.forEach(function(e,t){r[t]&&a[t]&&(c+=g.getStarBonus(r[t],"night",a[t]))});var p=0,h=0,f=0,d=0,y=0,S=[],v=0,A=0;l.forEach(function(e,n){if(r[n]){var i=r[n],o=!1,s=!1;i.type_ingame&&(45===i.type_ingame[3]?(s=!0,o=!0):46===i.type_ingame[3]&&(s=!0,o=!0)),b.TorpedoBombers.indexOf(i.type)>-1?i.hasName("Swordfish","ja_jp")&&(s=!0,v++):b.DiveBombers.indexOf(i.type)>-1&&i.hasName("岩井","ja_jp")&&(s=!0,A++),o&&(p+=e),s&&(h+=i.getStat("fire",t),f+=i.getStat("torpedo",t),d+=Math.sqrt(e)*((3+1.5*(o?1:0))*(i.getStat("fire",t)+i.getStat("torpedo",t)+i.getStat("bomb",t)+i.getStat("asw",t))/10),a[n]&&(y+=g.getStarBonus(r[n],"night",a[n])))}});var C=v+A;o.carrierFighterNight>=2&&o.torpedoBomberNight>=1&&S.push(1.25),o.carrierFighterNight>=1&&o.torpedoBomberNight>=1&&S.push(1.2),(o.carrierFighterNight>=3||o.carrierFighterNight>=2&&C>=1||o.carrierFighterNight>=1&&o.torpedoBomberNight>=1&&C>=1||o.carrierFighterNight>=1&&o.torpedoBomberNight>=2||o.carrierFighterNight>=1&&C>=2)&&S.push(1.18),u.type="航空",u.hit=1,u.damage=Math.floor(t.stat.fire_max+(s.fire||0)+h+f+3*p+d+y),u.isMax=!0,S.length&&(u.cis=S.map(function(e){return[Math.floor(u.damage*e),1]}))}else if(t.getCapability("participate_night_battle_when_equip_swordfish"))u.damage+=t.stat.fire_max+(s.fire||0)+t.stat.torpedo_max+(s.torpedo||0),l.forEach(function(e,a){var n=r[a];r[a]&&b.TorpedoBombers.indexOf(n.type)>-1&&n.name.ja_jp.indexOf("Swordfish")>-1&&(u.damage+=n.getStat("fire",t)+n.getStat("torpedo",t))}),u.type="通常",u.damage=Math.floor(u.damage),u.hit=1;else{if(t.stat.fire+t.stat.torpedo<=0)return{damage:0};var B={};l.forEach(function(e,t){if(r[t]&&(a[t]&&(c+=g.getStarBonus(r[t],"night",a[t])),r[t])){var n=r[t];B[n.id]?B[n.id]++:B[n.id]=1}}),u.damage=g.calcByShip.shellingPower(t,r,a,n,{isNight:!0},s)+g.calcByShip.torpedoPower(t,r,a,n,{isNight:!0,returnZero:!0},s)+c,g.shipType.Submarines.indexOf(t.type)>-1&&o.torpedoLateModel>=1&&o.submarineEquipment>=1?(u.type="雷击CI",u.damage=Math.floor(1.75*u.damage),u.hit=2):g.shipType.Submarines.indexOf(t.type)>-1&&o.torpedoLateModel>=2?(u.type="雷击CI",u.damage=Math.floor(1.6*u.damage),u.hit=2):o.torpedo>=2?(u.type="雷击CI",u.damage=Math.floor(1.5*u.damage),u.hit=2):o.main>=3?(u.type="炮击CI",u.damage=Math.floor(2*u.damage),u.hit=1):2==o.main&&o.secondary>=1?(u.type="炮击CI",u.damage=Math.floor(1.75*u.damage),u.hit=1):g.shipType.Destroyers.indexOf(t.type)>-1&&o.torpedo>=1&&o.radarSurface>=1&&o.surfaceShipPersonnel>=1?(u.type="电探CI",u.damage=Math.floor(1.25*u.damage),u.hit=1):g.shipType.Destroyers.indexOf(t.type)>-1&&o.torpedo>=1&&o.radarSurface>=1&&o.main>=1?(u.type="电雷CI",u.damage=B[267]?Math.floor(1.625*u.damage):Math.floor(1.3*u.damage),u.hit=1):o.main>=1&&1==o.torpedo?(u.type="炮雷CI",u.damage=Math.floor(1.3*u.damage),u.hit=2):2==o.main&&o.secondary<=0&&o.torpedo<=0||1==o.main&&o.secondary>=1&&o.torpedo<=0||0==o.main&&o.secondary>=2&&o.torpedo>=0?(u.type="连击",u.damage=Math.floor(1.2*u.damage),u.hit=2):(u.type="通常",u.damage=Math.floor(u.damage),u.hit=1)}var R=" ";if(u.isMax&&(R=" ≤ "),u.isMin&&(R=" ≥ "),u.value=""+u.type+R+u.damage,u.hit&&u.hit>1&&(u.value+=" x "+u.hit),Array.isArray(u.cis)&&u.cis.length)u.value+=" (CI"+R+u.cis.sort(function(e,t){return e[0]-t[0]}).map(function(e){return e[0]+(e[1]&&e[1]>1?" x "+e[1]:"")}).join(" 或 ")+")";else if(u.damage_ci){var L=u.hit_ci||u.hit||1;u.value+=" (CI"+R+u.damage_ci+")",L&&L>1&&(u.value+=" x "+L)}return u},g.calcByShip.fighterPower_v2=function(e,t,r,a){var n=[0,0];return m(e.slot).map(function(e,i){var o=g.calc.fighterPower(t[i],e,a[i]||0,r[i]||0);n[0]+=o[0],n[1]+=o[1]}),n},g.calcByShip.losPower=function(e,t,r,a,n){(n=n||{}).shipLv=n.shipLv||1,n.hqLv=n.hqLv||1,n.shipLv<0&&(n.shipLv=1),n.hqLv<0&&(n.hqLv=1);var i={DiveBombers:0,TorpedoBombers:0,CarrierRecons:0,SeaplaneRecons:0,SeaplaneBombers:0,SmallRadars:0,LargeRadars:0,Searchlights:0,statLos:Math.sqrt(e.getAttribute("los",n.shipLv)),hqLv:n.hqLv};return t.forEach(function(e){if(e)for(var t in i)b[t]&&b[t].push&&b[t].indexOf(e.type)>-1&&(i[t]+=e.stat.los)}),g.calc.losPower(i)},g.calcByShip.TP=function(e,t){if(!e||!t||!t.push)return 0;e=f(e);var r={ship:{},equipment:{}};return r.ship[e.type]=1,t.forEach(function(e){if(e){var t="number"==typeof e?e:d(e).id;r.equipment[t]||(r.equipment[t]=0),r.equipment[t]++}}),e.getCapability("count_as_landing_craft")&&(r.equipment[68]||(r.equipment[68]=0),r.equipment[68]++),g.calc.TP(r)},g.calcByShip.speed=function(e,r,n,i,o){if(!e)return"";if("object"===(void 0===n?"undefined":a(n))&&n.push)return g.calcByShip.speed(e,r,[],[],n);if("object"===(void 0===i?"undefined":a(i))&&i.push)return g.calcByShip.speed(e,r,n,[],i);e=f(e),r=r||[],o=o||{};var s=parseInt(e.stat.speed),u=function(e){return e=Math.min(20,e||s),o.returnNumber?e:t.statSpeed[e]},c={33:0,34:0,87:0},l=e._speedRule||"low-2",p=0;if(r.forEach(function(e){if(e){var t="number"==typeof e?e:d(e).id;void 0!==c[""+t]&&c[""+t]++}}),!c[33])return u();switch(l){case"low-1":p=.3*Math.min(c[34],1)+.7*c[87];break;case"low-2":case"high-3":(c[34]||c[87])&&(p=Math.min(1,c[34]/3+.5*c[87]));break;case"low-3":case"high-4":(c[34]||c[87])&&(s+=5);break;case"high-1":p=.5*c[34]+1*c[87];break;case"high-2":p=.5*c[34]+.5*c[87];break;case"low-4":p=.5}return p>0&&p<1?s+=5:p>=1&&p<1.5?s+=10:p>=1.5&&(s+=15),u()},g.calcByShip.fireRange=function(e,r){if(!e)return"-";r=r||[];var a=parseInt(e.stat.range);return r.forEach(function(e){e&&(a=Math.max(a,d(e).stat.range||0))}),t.statRange[a]},g.calcByFleet.los33=function(e,t){var r=[],a=[];return e.forEach(function(e){if(Array.isArray(e)){var t=e[0];if(t){var n=e[2],i=e[3],o=e[4];a.push({id:t,lv:e[1][0]}),n.forEach(function(e,t){r.push({id:e,star:i[t],rank:o[t]})})}}}),g.calc.los33({hq:t,equipments:r,ships:a})},g.calcByField.fighterPowerAA=function(e){var t=[0,0],r=1;function a(e){return r=Math.max(e,r)}return e.forEach(function(e){var r=d(e[0]||e.equipment||e.equipmentId),n=e[1]||e.star||0,i=e[2]||e.rank||0,o=e[3]||e.carry||0,s=g.calc.fighterPowerAA(r,o,i,n);switch(o||(o=g.equipmentType.Recons.indexOf(r.type)>-1?4:18),t[0]+=s[0],t[1]+=s[1],r.type){case b.CarrierRecon:case b.CarrierRecon2:r.stat.los<=7?a(1.2):r.stat.los>=9?a(1.3):a(1.25);break;case b.ReconSeaplane:case b.ReconSeaplaneNight:case b.LargeFlyingBoat:r.stat.los<=7?a(1.1):r.stat.los>=9?a(1.16):a(1.13)}}),t[0]=t[0]*r,t[1]=t[1]*r,t},g.getBonus=function(t,r,a,n,i){return e(t,r,a,n,i)},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var r;if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),n=a.length>>>0;if(0===n)return-1;var i=+t||0;if(Math.abs(i)===1/0&&(i=0),i>=n)return-1;for(r=Math.max(i>=0?i:n-Math.abs(i),0);r<n;){if(r in a&&a[r]===e)return r;r++}return-1}),t.Entity=c,t.Equipment=l,t.Ship=p,t.Consumable=h,t.formula=g,t}()}]);